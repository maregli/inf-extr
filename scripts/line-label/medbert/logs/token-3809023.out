=====================================================================
                   Welcome to Leonhard Med v.2.0.1                    

 * Documentation:  https://unlimited.ethz.ch/display/LEOMED2
 * Support:        leomed-support@id.ethz.ch
 * Software stack: type "enable_modules" to use Modules

Tenant name: BIOMED
OS: Ubuntu 20.04.6 LTS x86_64 
Uptime: 5 days, 1 hour, 47 mins 
CPU: Intel Xeon (Cascadelake) (34) @ 2.599GHz 
CPU Usage: 69% 
GPU: NVIDIA GeForce RTX 2080 Ti 
GPU: NVIDIA GeForce RTX 2080 Ti 
GPU: NVIDIA GeForce RTX 2080 Ti 
GPU: NVIDIA GeForce RTX 2080 Ti 
GPU: NVIDIA GeForce RTX 2080 Ti 
GPU: NVIDIA GeForce RTX 2080 Ti 
GPU: NVIDIA GeForce RTX 2080 Ti 
GPU: NVIDIA GeForce RTX 2080 Ti 
Memory: 104826MiB / 365879MiB (28%) 

=====================================================================
Starting job with ID 3809023...
Parsed Arguments:
job_id: unknown
model_name: medbert-512
quantization: None
task_type: token
batch_size: 8
lr: 2e-05
num_epochs: 12
gradient_accumulation_steps: 1
peft_config: None
attn_implementation: None
GPU 0: NVIDIA GeForce RTX 2080 Ti
   Total Memory: 10.75 GB
   Free Memory: 10.20 GB
   Allocated Memory : 0.00 GB
   Reserved Memory : 0.00 GB
Loaded Data
Added special token [BRK] to tokenizer
Tokenizer pad token ID: 0
Tokenizer special tokens: {'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]', 'additional_special_tokens': ['[BRK]']}
Model pad token ID: 0
Loaded Model and Tokenizer
Got Optimizer, Scheduler and DataCollator
Starting Training
{'eval_loss': 1.7736889123916626, 'eval_precision': 0.04310344827586207, 'eval_recall': 0.14285714285714285, 'eval_f1': 0.06622516556291391, 'eval_accuracy': 0.521044992743106, 'eval_runtime': 0.1251, 'eval_samples_per_second': 31.965, 'eval_steps_per_second': 7.991, 'epoch': 1.0}
{'loss': 1.9864, 'learning_rate': 1.7222222222222224e-05, 'epoch': 1.43}
{'eval_loss': 1.1601080894470215, 'eval_precision': 0.10227272727272728, 'eval_recall': 0.2571428571428571, 'eval_f1': 0.14634146341463414, 'eval_accuracy': 0.6952104499274311, 'eval_runtime': 0.1139, 'eval_samples_per_second': 35.124, 'eval_steps_per_second': 8.781, 'epoch': 2.0}
{'loss': 1.0489, 'learning_rate': 1.4444444444444446e-05, 'epoch': 2.86}
{'eval_loss': 0.8030105829238892, 'eval_precision': 0.19834710743801653, 'eval_recall': 0.34285714285714286, 'eval_f1': 0.25130890052356025, 'eval_accuracy': 0.7793904208998549, 'eval_runtime': 0.0801, 'eval_samples_per_second': 49.928, 'eval_steps_per_second': 12.482, 'epoch': 3.0}
{'eval_loss': 0.6520181894302368, 'eval_precision': 0.22807017543859648, 'eval_recall': 0.37142857142857144, 'eval_f1': 0.2826086956521739, 'eval_accuracy': 0.7939042089985486, 'eval_runtime': 0.0786, 'eval_samples_per_second': 50.86, 'eval_steps_per_second': 12.715, 'epoch': 4.0}
{'loss': 0.6459, 'learning_rate': 1.1666666666666668e-05, 'epoch': 4.29}
{'eval_loss': 0.5692708492279053, 'eval_precision': 0.2222222222222222, 'eval_recall': 0.37142857142857144, 'eval_f1': 0.27807486631016043, 'eval_accuracy': 0.818577648766328, 'eval_runtime': 0.0931, 'eval_samples_per_second': 42.968, 'eval_steps_per_second': 10.742, 'epoch': 5.0}
{'loss': 0.4711, 'learning_rate': 8.888888888888888e-06, 'epoch': 5.71}
{'eval_loss': 0.4641259014606476, 'eval_precision': 0.3942307692307692, 'eval_recall': 0.5857142857142857, 'eval_f1': 0.47126436781609193, 'eval_accuracy': 0.8592162554426706, 'eval_runtime': 0.1041, 'eval_samples_per_second': 38.437, 'eval_steps_per_second': 9.609, 'epoch': 6.0}
{'eval_loss': 0.4228705167770386, 'eval_precision': 0.43, 'eval_recall': 0.6142857142857143, 'eval_f1': 0.5058823529411766, 'eval_accuracy': 0.8664731494920174, 'eval_runtime': 0.2444, 'eval_samples_per_second': 16.365, 'eval_steps_per_second': 4.091, 'epoch': 7.0}
{'loss': 0.3452, 'learning_rate': 6.111111111111112e-06, 'epoch': 7.14}
{'eval_loss': 0.38699811697006226, 'eval_precision': 0.5393258426966292, 'eval_recall': 0.6857142857142857, 'eval_f1': 0.6037735849056604, 'eval_accuracy': 0.8896952104499274, 'eval_runtime': 0.1534, 'eval_samples_per_second': 26.07, 'eval_steps_per_second': 6.518, 'epoch': 8.0}
{'loss': 0.2949, 'learning_rate': 3.3333333333333333e-06, 'epoch': 8.57}
{'eval_loss': 0.36402663588523865, 'eval_precision': 0.5813953488372093, 'eval_recall': 0.7142857142857143, 'eval_f1': 0.6410256410256411, 'eval_accuracy': 0.895500725689405, 'eval_runtime': 0.0879, 'eval_samples_per_second': 45.526, 'eval_steps_per_second': 11.382, 'epoch': 9.0}
{'loss': 0.2879, 'learning_rate': 5.555555555555555e-07, 'epoch': 10.0}
{'eval_loss': 0.35999229550361633, 'eval_precision': 0.6, 'eval_recall': 0.7285714285714285, 'eval_f1': 0.6580645161290323, 'eval_accuracy': 0.8969521044992743, 'eval_runtime': 0.0978, 'eval_samples_per_second': 40.907, 'eval_steps_per_second': 10.227, 'epoch': 10.0}
{'eval_loss': 0.359987735748291, 'eval_precision': 0.6, 'eval_recall': 0.7285714285714285, 'eval_f1': 0.6580645161290323, 'eval_accuracy': 0.8969521044992743, 'eval_runtime': 0.0904, 'eval_samples_per_second': 44.266, 'eval_steps_per_second': 11.067, 'epoch': 11.0}
{'loss': 0.2614, 'learning_rate': 0.0, 'epoch': 11.43}
{'eval_loss': 0.359987735748291, 'eval_precision': 0.6, 'eval_recall': 0.7285714285714285, 'eval_f1': 0.6580645161290323, 'eval_accuracy': 0.8969521044992743, 'eval_runtime': 0.0791, 'eval_samples_per_second': 50.579, 'eval_steps_per_second': 12.645, 'epoch': 12.0}
{'train_runtime': 76.9168, 'train_samples_per_second': 8.581, 'train_steps_per_second': 1.092, 'train_loss': 0.6488749626136961, 'epoch': 12.0}
Finished Training
Saving Model at: /cluster/dataset/midatams/inf-extr/resources/models/line-label_medbert-512_token_finetuned
Saving Tokenizer at: /cluster/dataset/midatams/inf-extr/resources/models/line-label_medbert-512_token_finetuned
Job finished
