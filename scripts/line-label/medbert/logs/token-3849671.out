=====================================================================
                   Welcome to Leonhard Med v.2.0.1                    

 * Documentation:  https://unlimited.ethz.ch/display/LEOMED2
 * Support:        leomed-support@id.ethz.ch
 * Software stack: type "enable_modules" to use Modules

Tenant name: BIOMED
OS: Ubuntu 20.04.6 LTS x86_64 
Uptime: 9 days, 15 hours, 5 mins 
CPU: Intel Xeon (Cascadelake) (34) @ 2.593GHz 
CPU Usage: 19% 
GPU: NVIDIA GeForce RTX 2080 Ti 
GPU: NVIDIA GeForce RTX 2080 Ti 
GPU: NVIDIA GeForce RTX 2080 Ti 
GPU: NVIDIA GeForce RTX 2080 Ti 
GPU: NVIDIA GeForce RTX 2080 Ti 
GPU: NVIDIA GeForce RTX 2080 Ti 
GPU: NVIDIA GeForce RTX 2080 Ti 
GPU: NVIDIA GeForce RTX 2080 Ti 
Memory: 8624MiB / 365879MiB (2%) 

=====================================================================
Starting job with ID 3849671...
Parsed Arguments:
job_id: unknown
model_name: medbert-512
quantization: None
task_type: token
batch_size: 8
lr: 2e-05
num_epochs: 20
gradient_accumulation_steps: 1
peft_config: None
attn_implementation: None
GPU 0: NVIDIA GeForce RTX 2080 Ti
   Total Memory: 10.75 GB
   Free Memory: 10.20 GB
   Allocated Memory : 0.00 GB
   Reserved Memory : 0.00 GB
Loaded Data
Added special token [BRK] to tokenizer
Tokenizer pad token ID: 0
Tokenizer special tokens: {'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]', 'additional_special_tokens': ['[BRK]']}
Model pad token ID: 0
Loaded Model and Tokenizer
Got Optimizer, Scheduler and DataCollator
Starting Training
{'eval_loss': 1.7885547876358032, 'eval_precision': 0.025974025974025976, 'eval_recall': 0.08571428571428572, 'eval_f1': 0.03986710963455149, 'eval_accuracy': 0.4862119013062409, 'eval_runtime': 0.0856, 'eval_samples_per_second': 46.722, 'eval_steps_per_second': 11.68, 'epoch': 1.0}
{'loss': 2.1045, 'learning_rate': 1.8333333333333333e-05, 'epoch': 1.43}
{'eval_loss': 1.2017797231674194, 'eval_precision': 0.08139534883720931, 'eval_recall': 0.2, 'eval_f1': 0.115702479338843, 'eval_accuracy': 0.6516690856313497, 'eval_runtime': 0.0783, 'eval_samples_per_second': 51.096, 'eval_steps_per_second': 12.774, 'epoch': 2.0}
{'loss': 1.0644, 'learning_rate': 1.6666666666666667e-05, 'epoch': 2.86}
{'eval_loss': 0.7742353677749634, 'eval_precision': 0.15702479338842976, 'eval_recall': 0.2714285714285714, 'eval_f1': 0.19895287958115182, 'eval_accuracy': 0.7866473149492017, 'eval_runtime': 0.1965, 'eval_samples_per_second': 20.36, 'eval_steps_per_second': 5.09, 'epoch': 3.0}
{'eval_loss': 0.5916620492935181, 'eval_precision': 0.28431372549019607, 'eval_recall': 0.4142857142857143, 'eval_f1': 0.3372093023255814, 'eval_accuracy': 0.8171262699564587, 'eval_runtime': 0.0825, 'eval_samples_per_second': 48.456, 'eval_steps_per_second': 12.114, 'epoch': 4.0}
{'loss': 0.6342, 'learning_rate': 1.5000000000000002e-05, 'epoch': 4.29}
{'eval_loss': 0.4923628568649292, 'eval_precision': 0.330188679245283, 'eval_recall': 0.5, 'eval_f1': 0.3977272727272727, 'eval_accuracy': 0.8359941944847605, 'eval_runtime': 0.2073, 'eval_samples_per_second': 19.299, 'eval_steps_per_second': 4.825, 'epoch': 5.0}
{'loss': 0.4264, 'learning_rate': 1.3333333333333333e-05, 'epoch': 5.71}
{'eval_loss': 0.3840082287788391, 'eval_precision': 0.6046511627906976, 'eval_recall': 0.7428571428571429, 'eval_f1': 0.6666666666666666, 'eval_accuracy': 0.8708272859216255, 'eval_runtime': 0.0829, 'eval_samples_per_second': 48.28, 'eval_steps_per_second': 12.07, 'epoch': 6.0}
{'eval_loss': 0.3410490155220032, 'eval_precision': 0.6962025316455697, 'eval_recall': 0.7857142857142857, 'eval_f1': 0.738255033557047, 'eval_accuracy': 0.8751814223512336, 'eval_runtime': 0.0775, 'eval_samples_per_second': 51.625, 'eval_steps_per_second': 12.906, 'epoch': 7.0}
{'loss': 0.28, 'learning_rate': 1.1666666666666668e-05, 'epoch': 7.14}
{'eval_loss': 0.30475664138793945, 'eval_precision': 0.6111111111111112, 'eval_recall': 0.7857142857142857, 'eval_f1': 0.6875000000000001, 'eval_accuracy': 0.8780841799709724, 'eval_runtime': 0.0776, 'eval_samples_per_second': 51.524, 'eval_steps_per_second': 12.881, 'epoch': 8.0}
{'loss': 0.208, 'learning_rate': 1e-05, 'epoch': 8.57}
{'eval_loss': 0.27917373180389404, 'eval_precision': 0.651685393258427, 'eval_recall': 0.8285714285714286, 'eval_f1': 0.7295597484276731, 'eval_accuracy': 0.8984034833091437, 'eval_runtime': 0.0774, 'eval_samples_per_second': 51.699, 'eval_steps_per_second': 12.925, 'epoch': 9.0}
{'loss': 0.1716, 'learning_rate': 8.333333333333334e-06, 'epoch': 10.0}
{'eval_loss': 0.3172980844974518, 'eval_precision': 0.6781609195402298, 'eval_recall': 0.8428571428571429, 'eval_f1': 0.751592356687898, 'eval_accuracy': 0.8824383164005806, 'eval_runtime': 0.0701, 'eval_samples_per_second': 57.047, 'eval_steps_per_second': 14.262, 'epoch': 10.0}
{'eval_loss': 0.31558775901794434, 'eval_precision': 0.75, 'eval_recall': 0.8571428571428571, 'eval_f1': 0.7999999999999999, 'eval_accuracy': 0.888243831640058, 'eval_runtime': 0.0773, 'eval_samples_per_second': 51.76, 'eval_steps_per_second': 12.94, 'epoch': 11.0}
{'loss': 0.1229, 'learning_rate': 6.666666666666667e-06, 'epoch': 11.43}
{'eval_loss': 0.3110330402851105, 'eval_precision': 0.6818181818181818, 'eval_recall': 0.8571428571428571, 'eval_f1': 0.759493670886076, 'eval_accuracy': 0.8896952104499274, 'eval_runtime': 0.2426, 'eval_samples_per_second': 16.486, 'eval_steps_per_second': 4.122, 'epoch': 12.0}
{'loss': 0.1004, 'learning_rate': 5e-06, 'epoch': 12.86}
{'eval_loss': 0.29990336298942566, 'eval_precision': 0.6521739130434783, 'eval_recall': 0.8571428571428571, 'eval_f1': 0.7407407407407407, 'eval_accuracy': 0.8984034833091437, 'eval_runtime': 0.0779, 'eval_samples_per_second': 51.348, 'eval_steps_per_second': 12.837, 'epoch': 13.0}
{'eval_loss': 0.28440889716148376, 'eval_precision': 0.6976744186046512, 'eval_recall': 0.8571428571428571, 'eval_f1': 0.7692307692307693, 'eval_accuracy': 0.9056603773584906, 'eval_runtime': 0.0771, 'eval_samples_per_second': 51.856, 'eval_steps_per_second': 12.964, 'epoch': 14.0}
{'loss': 0.1005, 'learning_rate': 3.3333333333333333e-06, 'epoch': 14.29}
{'eval_loss': 0.2829180657863617, 'eval_precision': 0.6976744186046512, 'eval_recall': 0.8571428571428571, 'eval_f1': 0.7692307692307693, 'eval_accuracy': 0.9027576197387518, 'eval_runtime': 0.0786, 'eval_samples_per_second': 50.874, 'eval_steps_per_second': 12.719, 'epoch': 15.0}
{'loss': 0.077, 'learning_rate': 1.6666666666666667e-06, 'epoch': 15.71}
{'eval_loss': 0.3051240146160126, 'eval_precision': 0.6896551724137931, 'eval_recall': 0.8571428571428571, 'eval_f1': 0.7643312101910829, 'eval_accuracy': 0.895500725689405, 'eval_runtime': 0.0786, 'eval_samples_per_second': 50.885, 'eval_steps_per_second': 12.721, 'epoch': 16.0}
{'eval_loss': 0.30967840552330017, 'eval_precision': 0.6593406593406593, 'eval_recall': 0.8571428571428571, 'eval_f1': 0.7453416149068323, 'eval_accuracy': 0.8940493468795355, 'eval_runtime': 0.0776, 'eval_samples_per_second': 51.547, 'eval_steps_per_second': 12.887, 'epoch': 17.0}
{'loss': 0.0794, 'learning_rate': 0.0, 'epoch': 17.14}
{'eval_loss': 0.3097727298736572, 'eval_precision': 0.6593406593406593, 'eval_recall': 0.8571428571428571, 'eval_f1': 0.7453416149068323, 'eval_accuracy': 0.8940493468795355, 'eval_runtime': 0.0797, 'eval_samples_per_second': 50.183, 'eval_steps_per_second': 12.546, 'epoch': 18.0}
{'loss': 0.0743, 'learning_rate': 0.0, 'epoch': 18.57}
{'eval_loss': 0.3097727298736572, 'eval_precision': 0.6593406593406593, 'eval_recall': 0.8571428571428571, 'eval_f1': 0.7453416149068323, 'eval_accuracy': 0.8940493468795355, 'eval_runtime': 0.1033, 'eval_samples_per_second': 38.721, 'eval_steps_per_second': 9.68, 'epoch': 19.0}
{'loss': 0.0759, 'learning_rate': 0.0, 'epoch': 20.0}
{'eval_loss': 0.3097727298736572, 'eval_precision': 0.6593406593406593, 'eval_recall': 0.8571428571428571, 'eval_f1': 0.7453416149068323, 'eval_accuracy': 0.8940493468795355, 'eval_runtime': 0.0724, 'eval_samples_per_second': 55.256, 'eval_steps_per_second': 13.814, 'epoch': 20.0}
{'train_runtime': 115.8118, 'train_samples_per_second': 9.498, 'train_steps_per_second': 1.209, 'train_loss': 0.3942542829683849, 'epoch': 20.0}
Finished Training
Saving Model at: /cluster/dataset/midatams/inf-extr/resources/models/line-label_medbert-512_token
Saving Tokenizer at: /cluster/dataset/midatams/inf-extr/resources/models/line-label_medbert-512_token
Job finished
