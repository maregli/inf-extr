=====================================================================
                   Welcome to Leonhard Med v.2.0.1                    

 * Documentation:  https://unlimited.ethz.ch/display/LEOMED2
 * Support:        leomed-support@id.ethz.ch
 * Software stack: type "enable_modules" to use Modules

Tenant name: BIOMED
OS: Ubuntu 20.04.6 LTS x86_64 
Uptime: 9 days, 3 hours, 19 mins 
CPU: Intel (Broadwell, IBRS) (18) @ 2.199GHz 
CPU Usage: 4% 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
Memory: 1613MiB / 243821MiB (0%) 

=====================================================================
Starting job with ID 3849653...
Parsed Arguments:
job_id: unknown
model_name: medbert-512
peft_config: None
quantization: None
task_type: class
batch_size: 8
lr: 2e-05
num_epochs: 20
gradient_accumulation_steps: 1
num_labels: None
GPU 0: NVIDIA GeForce GTX 1080 Ti
   Total Memory: 10.91 GB
   Free Memory: 10.45 GB
   Allocated Memory : 0.00 GB
   Reserved Memory : 0.00 GB
Automatically inferred NUM_LABELS to: 8
Loaded Data
Tokenizer pad token ID: 0
Tokenizer special tokens: {'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'}
Model pad token ID: 0
Loaded Model and Tokenizer
Got Optimizer and Scheduler
Starting Training
{'loss': 1.9259, 'learning_rate': 1.9824561403508773e-05, 'epoch': 0.17}
{'loss': 1.3298, 'learning_rate': 1.9649122807017544e-05, 'epoch': 0.35}
{'loss': 0.8888, 'learning_rate': 1.9473684210526318e-05, 'epoch': 0.52}
{'loss': 0.5753, 'learning_rate': 1.929824561403509e-05, 'epoch': 0.7}
{'loss': 0.7015, 'learning_rate': 1.912280701754386e-05, 'epoch': 0.87}
{'eval_loss': 0.3417983055114746, 'eval_accuracy': 0.9069767441860465, 'eval_precision': 0.9439758610954263, 'eval_recall': 0.796340811965812, 'eval_f1': 0.8134136935188296, 'eval_runtime': 0.6533, 'eval_samples_per_second': 394.916, 'eval_steps_per_second': 50.513, 'epoch': 1.0}
{'loss': 0.6199, 'learning_rate': 1.894736842105263e-05, 'epoch': 1.04}
{'loss': 0.3572, 'learning_rate': 1.8771929824561405e-05, 'epoch': 1.22}
{'loss': 0.2748, 'learning_rate': 1.8596491228070176e-05, 'epoch': 1.39}
{'loss': 0.461, 'learning_rate': 1.8421052631578947e-05, 'epoch': 1.57}
{'loss': 0.4105, 'learning_rate': 1.824561403508772e-05, 'epoch': 1.74}
{'loss': 0.4126, 'learning_rate': 1.8070175438596493e-05, 'epoch': 1.91}
{'eval_loss': 0.2844291627407074, 'eval_accuracy': 0.9224806201550387, 'eval_precision': 0.9053726748856754, 'eval_recall': 0.8612580128205128, 'eval_f1': 0.8719007606414624, 'eval_runtime': 0.6657, 'eval_samples_per_second': 387.556, 'eval_steps_per_second': 49.571, 'epoch': 2.0}
{'loss': 0.2807, 'learning_rate': 1.7894736842105264e-05, 'epoch': 2.09}
{'loss': 0.1931, 'learning_rate': 1.7719298245614035e-05, 'epoch': 2.26}
{'loss': 0.2008, 'learning_rate': 1.754385964912281e-05, 'epoch': 2.43}
{'loss': 0.2056, 'learning_rate': 1.736842105263158e-05, 'epoch': 2.61}
{'loss': 0.3662, 'learning_rate': 1.719298245614035e-05, 'epoch': 2.78}
{'loss': 0.1853, 'learning_rate': 1.7017543859649125e-05, 'epoch': 2.96}
{'eval_loss': 0.3015338182449341, 'eval_accuracy': 0.9341085271317829, 'eval_precision': 0.9140128968253968, 'eval_recall': 0.8599759615384616, 'eval_f1': 0.8748024217519843, 'eval_runtime': 0.6359, 'eval_samples_per_second': 405.708, 'eval_steps_per_second': 51.893, 'epoch': 3.0}
{'loss': 0.1955, 'learning_rate': 1.6842105263157896e-05, 'epoch': 3.13}
{'loss': 0.138, 'learning_rate': 1.6666666666666667e-05, 'epoch': 3.3}
{'loss': 0.0941, 'learning_rate': 1.649122807017544e-05, 'epoch': 3.48}
{'loss': 0.1134, 'learning_rate': 1.6315789473684213e-05, 'epoch': 3.65}
{'loss': 0.2054, 'learning_rate': 1.6140350877192984e-05, 'epoch': 3.83}
{'loss': 0.1368, 'learning_rate': 1.5964912280701755e-05, 'epoch': 4.0}
{'eval_loss': 0.3042660355567932, 'eval_accuracy': 0.9341085271317829, 'eval_precision': 0.9170524222154657, 'eval_recall': 0.8757077991452991, 'eval_f1': 0.8930386570826782, 'eval_runtime': 0.6271, 'eval_samples_per_second': 411.411, 'eval_steps_per_second': 52.622, 'epoch': 4.0}
{'loss': 0.0796, 'learning_rate': 1.578947368421053e-05, 'epoch': 4.17}
{'loss': 0.1266, 'learning_rate': 1.56140350877193e-05, 'epoch': 4.35}
{'loss': 0.0953, 'learning_rate': 1.543859649122807e-05, 'epoch': 4.52}
{'loss': 0.0465, 'learning_rate': 1.5263157894736846e-05, 'epoch': 4.7}
{'loss': 0.2602, 'learning_rate': 1.5087719298245615e-05, 'epoch': 4.87}
{'eval_loss': 0.44571536779403687, 'eval_accuracy': 0.9108527131782945, 'eval_precision': 0.8783597661300836, 'eval_recall': 0.8360176282051283, 'eval_f1': 0.8507575308430586, 'eval_runtime': 0.6467, 'eval_samples_per_second': 398.977, 'eval_steps_per_second': 51.032, 'epoch': 5.0}
{'loss': 0.0829, 'learning_rate': 1.4912280701754388e-05, 'epoch': 5.04}
{'loss': 0.1053, 'learning_rate': 1.4736842105263159e-05, 'epoch': 5.22}
{'loss': 0.1224, 'learning_rate': 1.4561403508771931e-05, 'epoch': 5.39}
{'loss': 0.0692, 'learning_rate': 1.4385964912280704e-05, 'epoch': 5.57}
{'loss': 0.096, 'learning_rate': 1.4210526315789475e-05, 'epoch': 5.74}
{'loss': 0.0383, 'learning_rate': 1.4035087719298246e-05, 'epoch': 5.91}
{'eval_loss': 0.38139915466308594, 'eval_accuracy': 0.9263565891472868, 'eval_precision': 0.8841250763125763, 'eval_recall': 0.8671607905982907, 'eval_f1': 0.8716791663534895, 'eval_runtime': 0.6401, 'eval_samples_per_second': 403.074, 'eval_steps_per_second': 51.556, 'epoch': 6.0}
{'loss': 0.0719, 'learning_rate': 1.385964912280702e-05, 'epoch': 6.09}
{'loss': 0.0835, 'learning_rate': 1.3684210526315791e-05, 'epoch': 6.26}
{'loss': 0.0864, 'learning_rate': 1.3508771929824562e-05, 'epoch': 6.43}
{'loss': 0.0917, 'learning_rate': 1.3333333333333333e-05, 'epoch': 6.61}
{'loss': 0.0593, 'learning_rate': 1.3157894736842108e-05, 'epoch': 6.78}
{'loss': 0.0588, 'learning_rate': 1.2982456140350879e-05, 'epoch': 6.96}
{'eval_loss': 0.3492319583892822, 'eval_accuracy': 0.9302325581395349, 'eval_precision': 0.9077857905982907, 'eval_recall': 0.8645566239316239, 'eval_f1': 0.876254409752312, 'eval_runtime': 0.6424, 'eval_samples_per_second': 401.599, 'eval_steps_per_second': 51.367, 'epoch': 7.0}
{'loss': 0.0512, 'learning_rate': 1.280701754385965e-05, 'epoch': 7.13}
{'loss': 0.0628, 'learning_rate': 1.263157894736842e-05, 'epoch': 7.3}
{'loss': 0.0556, 'learning_rate': 1.2456140350877195e-05, 'epoch': 7.48}
{'loss': 0.0269, 'learning_rate': 1.2280701754385966e-05, 'epoch': 7.65}
{'loss': 0.0395, 'learning_rate': 1.2105263157894737e-05, 'epoch': 7.83}
{'loss': 0.072, 'learning_rate': 1.192982456140351e-05, 'epoch': 8.0}
{'eval_loss': 0.3745810389518738, 'eval_accuracy': 0.9302325581395349, 'eval_precision': 0.8947652757078987, 'eval_recall': 0.8658787393162393, 'eval_f1': 0.8772866275532577, 'eval_runtime': 0.6223, 'eval_samples_per_second': 414.596, 'eval_steps_per_second': 53.03, 'epoch': 8.0}
{'loss': 0.0723, 'learning_rate': 1.1754385964912282e-05, 'epoch': 8.17}
{'loss': 0.041, 'learning_rate': 1.1578947368421053e-05, 'epoch': 8.35}
{'loss': 0.0213, 'learning_rate': 1.1403508771929826e-05, 'epoch': 8.52}
{'loss': 0.0024, 'learning_rate': 1.1228070175438597e-05, 'epoch': 8.7}
{'loss': 0.0432, 'learning_rate': 1.105263157894737e-05, 'epoch': 8.87}
{'eval_loss': 0.42803800106048584, 'eval_accuracy': 0.9341085271317829, 'eval_precision': 0.9032986111111112, 'eval_recall': 0.8739316239316239, 'eval_f1': 0.8823986394168519, 'eval_runtime': 0.6413, 'eval_samples_per_second': 402.28, 'eval_steps_per_second': 51.454, 'epoch': 9.0}
{'loss': 0.0322, 'learning_rate': 1.0877192982456142e-05, 'epoch': 9.04}
{'loss': 0.0267, 'learning_rate': 1.0701754385964913e-05, 'epoch': 9.22}
{'loss': 0.0097, 'learning_rate': 1.0526315789473684e-05, 'epoch': 9.39}
{'loss': 0.0778, 'learning_rate': 1.0350877192982459e-05, 'epoch': 9.57}
{'loss': 0.0334, 'learning_rate': 1.017543859649123e-05, 'epoch': 9.74}
{'loss': 0.0027, 'learning_rate': 1e-05, 'epoch': 9.91}
{'eval_loss': 0.43108469247817993, 'eval_accuracy': 0.9263565891472868, 'eval_precision': 0.8923424766448023, 'eval_recall': 0.8619524572649573, 'eval_f1': 0.8707295738007519, 'eval_runtime': 0.6375, 'eval_samples_per_second': 404.735, 'eval_steps_per_second': 51.768, 'epoch': 10.0}
{'loss': 0.0383, 'learning_rate': 9.824561403508772e-06, 'epoch': 10.09}
{'loss': 0.0257, 'learning_rate': 9.649122807017545e-06, 'epoch': 10.26}
{'loss': 0.0481, 'learning_rate': 9.473684210526315e-06, 'epoch': 10.43}
{'loss': 0.0118, 'learning_rate': 9.298245614035088e-06, 'epoch': 10.61}
{'loss': 0.0542, 'learning_rate': 9.12280701754386e-06, 'epoch': 10.78}
{'loss': 0.0175, 'learning_rate': 8.947368421052632e-06, 'epoch': 10.96}
{'eval_loss': 0.4475775957107544, 'eval_accuracy': 0.9224806201550387, 'eval_precision': 0.8755645396270397, 'eval_recall': 0.8450854700854701, 'eval_f1': 0.855131337771424, 'eval_runtime': 0.638, 'eval_samples_per_second': 404.378, 'eval_steps_per_second': 51.723, 'epoch': 11.0}
{'loss': 0.0051, 'learning_rate': 8.771929824561405e-06, 'epoch': 11.13}
{'loss': 0.0479, 'learning_rate': 8.596491228070176e-06, 'epoch': 11.3}
{'loss': 0.0148, 'learning_rate': 8.421052631578948e-06, 'epoch': 11.48}
{'loss': 0.0017, 'learning_rate': 8.24561403508772e-06, 'epoch': 11.65}
{'loss': 0.0083, 'learning_rate': 8.070175438596492e-06, 'epoch': 11.83}
{'loss': 0.0305, 'learning_rate': 7.894736842105265e-06, 'epoch': 12.0}
{'eval_loss': 0.43317660689353943, 'eval_accuracy': 0.9341085271317829, 'eval_precision': 0.9022907267190804, 'eval_recall': 0.880181623931624, 'eval_f1': 0.8871012442755674, 'eval_runtime': 0.6183, 'eval_samples_per_second': 417.276, 'eval_steps_per_second': 53.373, 'epoch': 12.0}
{'loss': 0.0043, 'learning_rate': 7.719298245614036e-06, 'epoch': 12.17}
{'loss': 0.0014, 'learning_rate': 7.5438596491228074e-06, 'epoch': 12.35}
{'loss': 0.0207, 'learning_rate': 7.368421052631579e-06, 'epoch': 12.52}
{'loss': 0.0064, 'learning_rate': 7.192982456140352e-06, 'epoch': 12.7}
{'loss': 0.0193, 'learning_rate': 7.017543859649123e-06, 'epoch': 12.87}
{'eval_loss': 0.4582488238811493, 'eval_accuracy': 0.9341085271317829, 'eval_precision': 0.9022907267190804, 'eval_recall': 0.880181623931624, 'eval_f1': 0.8871012442755674, 'eval_runtime': 0.6384, 'eval_samples_per_second': 404.157, 'eval_steps_per_second': 51.694, 'epoch': 13.0}
{'loss': 0.0526, 'learning_rate': 6.842105263157896e-06, 'epoch': 13.04}
{'loss': 0.0024, 'learning_rate': 6.666666666666667e-06, 'epoch': 13.22}
{'loss': 0.0107, 'learning_rate': 6.491228070175439e-06, 'epoch': 13.39}
{'loss': 0.0141, 'learning_rate': 6.31578947368421e-06, 'epoch': 13.57}
{'loss': 0.0013, 'learning_rate': 6.140350877192983e-06, 'epoch': 13.74}
{'loss': 0.0159, 'learning_rate': 5.964912280701755e-06, 'epoch': 13.91}
{'eval_loss': 0.46314045786857605, 'eval_accuracy': 0.9302325581395349, 'eval_precision': 0.8902439574314575, 'eval_recall': 0.8643162393162394, 'eval_f1': 0.8728591657326414, 'eval_runtime': 0.6402, 'eval_samples_per_second': 402.991, 'eval_steps_per_second': 51.545, 'epoch': 14.0}
{'loss': 0.0013, 'learning_rate': 5.789473684210527e-06, 'epoch': 14.09}
{'loss': 0.0075, 'learning_rate': 5.6140350877192985e-06, 'epoch': 14.26}
{'loss': 0.0033, 'learning_rate': 5.438596491228071e-06, 'epoch': 14.43}
{'loss': 0.0561, 'learning_rate': 5.263157894736842e-06, 'epoch': 14.61}
{'loss': 0.0057, 'learning_rate': 5.087719298245615e-06, 'epoch': 14.78}
{'loss': 0.0013, 'learning_rate': 4.912280701754386e-06, 'epoch': 14.96}
{'eval_loss': 0.4573482573032379, 'eval_accuracy': 0.9302325581395349, 'eval_precision': 0.8956119887903424, 'eval_recall': 0.8669204059829061, 'eval_f1': 0.8779768618478296, 'eval_runtime': 0.6391, 'eval_samples_per_second': 403.689, 'eval_steps_per_second': 51.635, 'epoch': 15.0}
{'loss': 0.0011, 'learning_rate': 4.736842105263158e-06, 'epoch': 15.13}
{'loss': 0.0011, 'learning_rate': 4.56140350877193e-06, 'epoch': 15.3}
{'loss': 0.0025, 'learning_rate': 4.385964912280702e-06, 'epoch': 15.48}
{'loss': 0.004, 'learning_rate': 4.210526315789474e-06, 'epoch': 15.65}
{'loss': 0.013, 'learning_rate': 4.035087719298246e-06, 'epoch': 15.83}
{'loss': 0.001, 'learning_rate': 3.859649122807018e-06, 'epoch': 16.0}
{'eval_loss': 0.47625696659088135, 'eval_accuracy': 0.9224806201550387, 'eval_precision': 0.8793402777777779, 'eval_recall': 0.8523370726495727, 'eval_f1': 0.8617227698945851, 'eval_runtime': 0.6207, 'eval_samples_per_second': 415.651, 'eval_steps_per_second': 53.165, 'epoch': 16.0}
{'loss': 0.001, 'learning_rate': 3.6842105263157896e-06, 'epoch': 16.17}
{'loss': 0.0111, 'learning_rate': 3.5087719298245615e-06, 'epoch': 16.35}
{'loss': 0.0021, 'learning_rate': 3.3333333333333333e-06, 'epoch': 16.52}
{'loss': 0.001, 'learning_rate': 3.157894736842105e-06, 'epoch': 16.7}
{'loss': 0.0258, 'learning_rate': 2.9824561403508774e-06, 'epoch': 16.87}
{'eval_loss': 0.49322301149368286, 'eval_accuracy': 0.9224806201550387, 'eval_precision': 0.8793402777777779, 'eval_recall': 0.8523370726495727, 'eval_f1': 0.8617227698945851, 'eval_runtime': 0.6387, 'eval_samples_per_second': 403.915, 'eval_steps_per_second': 51.663, 'epoch': 17.0}
{'loss': 0.0011, 'learning_rate': 2.8070175438596493e-06, 'epoch': 17.04}
{'loss': 0.0012, 'learning_rate': 2.631578947368421e-06, 'epoch': 17.22}
{'loss': 0.0084, 'learning_rate': 2.456140350877193e-06, 'epoch': 17.39}
{'loss': 0.0009, 'learning_rate': 2.280701754385965e-06, 'epoch': 17.57}
{'loss': 0.0038, 'learning_rate': 2.105263157894737e-06, 'epoch': 17.74}
{'loss': 0.001, 'learning_rate': 1.929824561403509e-06, 'epoch': 17.91}
{'eval_loss': 0.4958850145339966, 'eval_accuracy': 0.9263565891472868, 'eval_precision': 0.8929048382173382, 'eval_recall': 0.8619524572649573, 'eval_f1': 0.8711660897326419, 'eval_runtime': 0.6394, 'eval_samples_per_second': 403.534, 'eval_steps_per_second': 51.615, 'epoch': 18.0}
{'loss': 0.0116, 'learning_rate': 1.7543859649122807e-06, 'epoch': 18.09}
{'loss': 0.001, 'learning_rate': 1.5789473684210526e-06, 'epoch': 18.26}
{'loss': 0.0009, 'learning_rate': 1.4035087719298246e-06, 'epoch': 18.43}
{'loss': 0.001, 'learning_rate': 1.2280701754385965e-06, 'epoch': 18.61}
{'loss': 0.0031, 'learning_rate': 1.0526315789473685e-06, 'epoch': 18.78}
{'loss': 0.001, 'learning_rate': 8.771929824561404e-07, 'epoch': 18.96}
{'eval_loss': 0.4955056309700012, 'eval_accuracy': 0.9263565891472868, 'eval_precision': 0.8929048382173382, 'eval_recall': 0.8619524572649573, 'eval_f1': 0.8711660897326419, 'eval_runtime': 0.6451, 'eval_samples_per_second': 399.951, 'eval_steps_per_second': 51.156, 'epoch': 19.0}
{'loss': 0.001, 'learning_rate': 7.017543859649123e-07, 'epoch': 19.13}
{'loss': 0.0009, 'learning_rate': 5.263157894736843e-07, 'epoch': 19.3}
{'loss': 0.0011, 'learning_rate': 3.5087719298245616e-07, 'epoch': 19.48}
{'loss': 0.0107, 'learning_rate': 1.7543859649122808e-07, 'epoch': 19.65}
{'loss': 0.0009, 'learning_rate': 0.0, 'epoch': 19.83}
{'loss': 0.001, 'learning_rate': 0.0, 'epoch': 20.0}
{'eval_loss': 0.4960068166255951, 'eval_accuracy': 0.9263565891472868, 'eval_precision': 0.8929048382173382, 'eval_recall': 0.8619524572649573, 'eval_f1': 0.8711660897326419, 'eval_runtime': 0.6253, 'eval_samples_per_second': 412.603, 'eval_steps_per_second': 52.775, 'epoch': 20.0}
{'train_runtime': 319.7823, 'train_samples_per_second': 57.352, 'train_steps_per_second': 7.192, 'train_loss': 0.11443003160312124, 'epoch': 20.0}
Finished Training
Saving Model at: /cluster/dataset/midatams/inf-extr/resources/models/line-label_medbert-512_class
Saving Tokenizer at: /cluster/dataset/midatams/inf-extr/resources/models/line-label_medbert-512_class
Job finished
