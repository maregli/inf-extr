=====================================================================
                   Welcome to Leonhard Med v.2.0.1                    

 * Documentation:  https://unlimited.ethz.ch/display/LEOMED2
 * Support:        leomed-support@id.ethz.ch
 * Software stack: type "enable_modules" to use Modules

Tenant name: BIOMED
OS: Ubuntu 20.04.6 LTS x86_64 
Uptime: 10 days, 2 hours, 4 mins 
CPU: Intel (Broadwell, IBRS) (18) @ 2.199GHz 
CPU Usage: 43% 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
Memory: 31803MiB / 243821MiB (13%) 

=====================================================================
Starting job with ID 3851347...
Parsed Arguments:
job_id: unknown
model_name: medbert-512
quantization: None
batch_size: 16
lr: 0.0002
num_epochs: 12
gradient_accumulation_steps: 1
task_type: class
data: all
data_augmentation: oversample
num_labels: 4
peft_config: None
attn_implementation: None
GPU 0: NVIDIA GeForce GTX 1080 Ti
   Total Memory: 10.91 GB
   Free Memory: 10.45 GB
   Allocated Memory : 0.00 GB
   Reserved Memory : 0.00 GB
Tokenizer pad token ID: 0
Tokenizer special tokens: {'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'}
Model pad token ID: 0
Loaded Model and Tokenizer
Loaded Data
Starting Training
{'loss': 1.5632, 'learning_rate': 0.0001866666666666667, 'epoch': 0.8}
{'eval_loss': 1.4226478338241577, 'eval_accuracy': 0.25, 'eval_f1': 0.1, 'eval_precision': 0.0625, 'eval_recall': 0.25, 'eval_runtime': 0.1044, 'eval_samples_per_second': 38.319, 'eval_steps_per_second': 9.58, 'epoch': 1.0}
{'loss': 1.4563, 'learning_rate': 0.00017333333333333334, 'epoch': 1.6}
{'eval_loss': 1.446152925491333, 'eval_accuracy': 0.25, 'eval_f1': 0.1, 'eval_precision': 0.0625, 'eval_recall': 0.25, 'eval_runtime': 0.0962, 'eval_samples_per_second': 41.587, 'eval_steps_per_second': 10.397, 'epoch': 2.0}
{'loss': 1.3855, 'learning_rate': 0.00016, 'epoch': 2.4}
{'eval_loss': 1.4330337047576904, 'eval_accuracy': 0.25, 'eval_f1': 0.1, 'eval_precision': 0.0625, 'eval_recall': 0.25, 'eval_runtime': 0.0972, 'eval_samples_per_second': 41.168, 'eval_steps_per_second': 10.292, 'epoch': 3.0}
{'loss': 1.4148, 'learning_rate': 0.00014666666666666666, 'epoch': 3.2}
{'loss': 1.4173, 'learning_rate': 0.00013333333333333334, 'epoch': 4.0}
{'eval_loss': 1.4166771173477173, 'eval_accuracy': 0.25, 'eval_f1': 0.1, 'eval_precision': 0.0625, 'eval_recall': 0.25, 'eval_runtime': 0.0831, 'eval_samples_per_second': 48.112, 'eval_steps_per_second': 12.028, 'epoch': 4.0}
{'loss': 1.263, 'learning_rate': 0.00012, 'epoch': 4.8}
{'eval_loss': 1.7077593803405762, 'eval_accuracy': 0.5, 'eval_f1': 0.3333333333333333, 'eval_precision': 0.25, 'eval_recall': 0.5, 'eval_runtime': 0.0959, 'eval_samples_per_second': 41.725, 'eval_steps_per_second': 10.431, 'epoch': 5.0}
{'loss': 1.2449, 'learning_rate': 0.00010666666666666667, 'epoch': 5.6}
{'eval_loss': 1.6709237098693848, 'eval_accuracy': 0.25, 'eval_f1': 0.1, 'eval_precision': 0.0625, 'eval_recall': 0.25, 'eval_runtime': 0.0951, 'eval_samples_per_second': 42.056, 'eval_steps_per_second': 10.514, 'epoch': 6.0}
{'loss': 1.1984, 'learning_rate': 9.333333333333334e-05, 'epoch': 6.4}
{'eval_loss': 1.7357701063156128, 'eval_accuracy': 0.25, 'eval_f1': 0.1, 'eval_precision': 0.0625, 'eval_recall': 0.25, 'eval_runtime': 0.0967, 'eval_samples_per_second': 41.38, 'eval_steps_per_second': 10.345, 'epoch': 7.0}
{'loss': 1.1716, 'learning_rate': 8e-05, 'epoch': 7.2}
{'loss': 1.2337, 'learning_rate': 6.666666666666667e-05, 'epoch': 8.0}
{'eval_loss': 1.4360551834106445, 'eval_accuracy': 0.5, 'eval_f1': 0.3333333333333333, 'eval_precision': 0.25, 'eval_recall': 0.5, 'eval_runtime': 0.0851, 'eval_samples_per_second': 47.02, 'eval_steps_per_second': 11.755, 'epoch': 8.0}
{'loss': 1.2573, 'learning_rate': 5.333333333333333e-05, 'epoch': 8.8}
{'eval_loss': 1.690457820892334, 'eval_accuracy': 0.25, 'eval_f1': 0.125, 'eval_precision': 0.08333333333333333, 'eval_recall': 0.25, 'eval_runtime': 0.0972, 'eval_samples_per_second': 41.151, 'eval_steps_per_second': 10.288, 'epoch': 9.0}
{'loss': 1.2252, 'learning_rate': 4e-05, 'epoch': 9.6}
{'eval_loss': 1.4434515237808228, 'eval_accuracy': 0.25, 'eval_f1': 0.16666666666666666, 'eval_precision': 0.125, 'eval_recall': 0.25, 'eval_runtime': 0.098, 'eval_samples_per_second': 40.796, 'eval_steps_per_second': 10.199, 'epoch': 10.0}
{'loss': 1.245, 'learning_rate': 2.6666666666666667e-05, 'epoch': 10.4}
{'eval_loss': 1.5125606060028076, 'eval_accuracy': 0.25, 'eval_f1': 0.16666666666666666, 'eval_precision': 0.125, 'eval_recall': 0.25, 'eval_runtime': 0.0962, 'eval_samples_per_second': 41.56, 'eval_steps_per_second': 10.39, 'epoch': 11.0}
{'loss': 1.2035, 'learning_rate': 1.3333333333333333e-05, 'epoch': 11.2}
{'loss': 1.2136, 'learning_rate': 0.0, 'epoch': 12.0}
{'eval_loss': 1.4781981706619263, 'eval_accuracy': 0.25, 'eval_f1': 0.16666666666666666, 'eval_precision': 0.125, 'eval_recall': 0.25, 'eval_runtime': 0.0834, 'eval_samples_per_second': 47.965, 'eval_steps_per_second': 11.991, 'epoch': 12.0}
{'train_runtime': 405.3947, 'train_samples_per_second': 11.84, 'train_steps_per_second': 0.74, 'train_loss': 1.2995713869730632, 'epoch': 12.0}
Finished Training
Saving Model at: /cluster/dataset/midatams/inf-extr/resources/models/ms-diag_medbert-512_class_all_oversample
Saving Tokenizer at: /cluster/dataset/midatams/inf-extr/resources/models/ms-diag_medbert-512_class_all_oversample
Job finished
