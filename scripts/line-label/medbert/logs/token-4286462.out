Starting job with ID 4286462...
Parsed Arguments:
job_id: unknown
model_name: medbert-512
quantization: None
task_type: token
batch_size: 8
lr: 2e-05
num_epochs: 20
gradient_accumulation_steps: 1
peft_config: None
attn_implementation: None
GPU 0: NVIDIA GeForce RTX 2080 Ti
   Total Memory: 10.75 GB
   Free Memory: 10.14 GB
   Allocated Memory : 0.00 GB
   Reserved Memory : 0.00 GB
Loaded Data
Added special token [BRK] to tokenizer
Tokenizer pad token ID: 0
Tokenizer special tokens: {'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]', 'additional_special_tokens': ['[BRK]']}
Model pad token ID: 0
Loaded Model and Tokenizer
Got Optimizer, Scheduler and DataCollator
Starting Training
{'eval_loss': 1.7866305112838745, 'eval_precision': 0.05069124423963134, 'eval_recall': 0.15714285714285714, 'eval_f1': 0.07665505226480837, 'eval_accuracy': 0.5166908563134979, 'eval_runtime': 0.0969, 'eval_samples_per_second': 41.3, 'eval_steps_per_second': 10.325, 'epoch': 1.0}
{'loss': 2.0155, 'learning_rate': 1.8333333333333333e-05, 'epoch': 1.43}
{'eval_loss': 1.160964012145996, 'eval_precision': 0.07575757575757576, 'eval_recall': 0.21428571428571427, 'eval_f1': 0.11194029850746268, 'eval_accuracy': 0.6792452830188679, 'eval_runtime': 0.0808, 'eval_samples_per_second': 49.503, 'eval_steps_per_second': 12.376, 'epoch': 2.0}
{'loss': 1.0767, 'learning_rate': 1.6666666666666667e-05, 'epoch': 2.86}
{'eval_loss': 0.7552843689918518, 'eval_precision': 0.14285714285714285, 'eval_recall': 0.24285714285714285, 'eval_f1': 0.1798941798941799, 'eval_accuracy': 0.7822931785195936, 'eval_runtime': 0.0898, 'eval_samples_per_second': 44.534, 'eval_steps_per_second': 11.133, 'epoch': 3.0}
{'eval_loss': 0.5933889746665955, 'eval_precision': 0.1885245901639344, 'eval_recall': 0.32857142857142857, 'eval_f1': 0.23958333333333331, 'eval_accuracy': 0.8084179970972424, 'eval_runtime': 0.0819, 'eval_samples_per_second': 48.849, 'eval_steps_per_second': 12.212, 'epoch': 4.0}
{'loss': 0.6428, 'learning_rate': 1.5000000000000002e-05, 'epoch': 4.29}
{'eval_loss': 0.48783332109451294, 'eval_precision': 0.2457627118644068, 'eval_recall': 0.4142857142857143, 'eval_f1': 0.30851063829787234, 'eval_accuracy': 0.8359941944847605, 'eval_runtime': 0.0807, 'eval_samples_per_second': 49.566, 'eval_steps_per_second': 12.391, 'epoch': 5.0}
{'loss': 0.4511, 'learning_rate': 1.3333333333333333e-05, 'epoch': 5.71}
{'eval_loss': 0.39674508571624756, 'eval_precision': 0.37383177570093457, 'eval_recall': 0.5714285714285714, 'eval_f1': 0.45197740112994345, 'eval_accuracy': 0.8708272859216255, 'eval_runtime': 0.1117, 'eval_samples_per_second': 35.824, 'eval_steps_per_second': 8.956, 'epoch': 6.0}
{'eval_loss': 0.35561856627464294, 'eval_precision': 0.4842105263157895, 'eval_recall': 0.6571428571428571, 'eval_f1': 0.5575757575757576, 'eval_accuracy': 0.8780841799709724, 'eval_runtime': 0.1271, 'eval_samples_per_second': 31.463, 'eval_steps_per_second': 7.866, 'epoch': 7.0}
{'loss': 0.3105, 'learning_rate': 1.1666666666666668e-05, 'epoch': 7.14}
{'eval_loss': 0.2914174199104309, 'eval_precision': 0.5714285714285714, 'eval_recall': 0.7428571428571429, 'eval_f1': 0.6459627329192547, 'eval_accuracy': 0.9013062409288825, 'eval_runtime': 0.0805, 'eval_samples_per_second': 49.674, 'eval_steps_per_second': 12.419, 'epoch': 8.0}
{'loss': 0.2345, 'learning_rate': 1e-05, 'epoch': 8.57}
{'eval_loss': 0.27684757113456726, 'eval_precision': 0.6666666666666666, 'eval_recall': 0.8, 'eval_f1': 0.7272727272727272, 'eval_accuracy': 0.9158200290275762, 'eval_runtime': 0.089, 'eval_samples_per_second': 44.936, 'eval_steps_per_second': 11.234, 'epoch': 9.0}
{'loss': 0.1957, 'learning_rate': 8.333333333333334e-06, 'epoch': 10.0}
{'eval_loss': 0.3021419048309326, 'eval_precision': 0.6547619047619048, 'eval_recall': 0.7857142857142857, 'eval_f1': 0.7142857142857143, 'eval_accuracy': 0.9042089985486212, 'eval_runtime': 0.0758, 'eval_samples_per_second': 52.746, 'eval_steps_per_second': 13.186, 'epoch': 10.0}
{'eval_loss': 0.25885143876075745, 'eval_precision': 0.7435897435897436, 'eval_recall': 0.8285714285714286, 'eval_f1': 0.7837837837837838, 'eval_accuracy': 0.9201741654571843, 'eval_runtime': 0.0808, 'eval_samples_per_second': 49.483, 'eval_steps_per_second': 12.371, 'epoch': 11.0}
{'loss': 0.1432, 'learning_rate': 6.666666666666667e-06, 'epoch': 11.43}
{'eval_loss': 0.25232261419296265, 'eval_precision': 0.6436781609195402, 'eval_recall': 0.8, 'eval_f1': 0.713375796178344, 'eval_accuracy': 0.9129172714078374, 'eval_runtime': 0.328, 'eval_samples_per_second': 12.197, 'eval_steps_per_second': 3.049, 'epoch': 12.0}
{'loss': 0.1056, 'learning_rate': 5e-06, 'epoch': 12.86}
{'eval_loss': 0.2694394588470459, 'eval_precision': 0.7073170731707317, 'eval_recall': 0.8285714285714286, 'eval_f1': 0.7631578947368421, 'eval_accuracy': 0.9114658925979681, 'eval_runtime': 0.0819, 'eval_samples_per_second': 48.855, 'eval_steps_per_second': 12.214, 'epoch': 13.0}
{'eval_loss': 0.2563105523586273, 'eval_precision': 0.7283950617283951, 'eval_recall': 0.8428571428571429, 'eval_f1': 0.7814569536423841, 'eval_accuracy': 0.9172714078374455, 'eval_runtime': 0.0843, 'eval_samples_per_second': 47.453, 'eval_steps_per_second': 11.863, 'epoch': 14.0}
{'loss': 0.1024, 'learning_rate': 3.3333333333333333e-06, 'epoch': 14.29}
{'eval_loss': 0.2564684748649597, 'eval_precision': 0.7195121951219512, 'eval_recall': 0.8428571428571429, 'eval_f1': 0.7763157894736842, 'eval_accuracy': 0.9129172714078374, 'eval_runtime': 0.0806, 'eval_samples_per_second': 49.636, 'eval_steps_per_second': 12.409, 'epoch': 15.0}
{'loss': 0.0901, 'learning_rate': 1.6666666666666667e-06, 'epoch': 15.71}
{'eval_loss': 0.2633123993873596, 'eval_precision': 0.6987951807228916, 'eval_recall': 0.8285714285714286, 'eval_f1': 0.758169934640523, 'eval_accuracy': 0.9071117561683599, 'eval_runtime': 0.0813, 'eval_samples_per_second': 49.2, 'eval_steps_per_second': 12.3, 'epoch': 16.0}
{'eval_loss': 0.26156026124954224, 'eval_precision': 0.6551724137931034, 'eval_recall': 0.8142857142857143, 'eval_f1': 0.7261146496815287, 'eval_accuracy': 0.9071117561683599, 'eval_runtime': 0.4178, 'eval_samples_per_second': 9.574, 'eval_steps_per_second': 2.393, 'epoch': 17.0}
{'loss': 0.085, 'learning_rate': 0.0, 'epoch': 17.14}
{'eval_loss': 0.2614806592464447, 'eval_precision': 0.6551724137931034, 'eval_recall': 0.8142857142857143, 'eval_f1': 0.7261146496815287, 'eval_accuracy': 0.9071117561683599, 'eval_runtime': 0.1327, 'eval_samples_per_second': 30.136, 'eval_steps_per_second': 7.534, 'epoch': 18.0}
{'loss': 0.0782, 'learning_rate': 0.0, 'epoch': 18.57}
{'eval_loss': 0.2614806592464447, 'eval_precision': 0.6551724137931034, 'eval_recall': 0.8142857142857143, 'eval_f1': 0.7261146496815287, 'eval_accuracy': 0.9071117561683599, 'eval_runtime': 0.1359, 'eval_samples_per_second': 29.429, 'eval_steps_per_second': 7.357, 'epoch': 19.0}
{'loss': 0.0867, 'learning_rate': 0.0, 'epoch': 20.0}
{'eval_loss': 0.2614806592464447, 'eval_precision': 0.6551724137931034, 'eval_recall': 0.8142857142857143, 'eval_f1': 0.7261146496815287, 'eval_accuracy': 0.9071117561683599, 'eval_runtime': 0.1342, 'eval_samples_per_second': 29.812, 'eval_steps_per_second': 7.453, 'epoch': 20.0}
{'train_runtime': 124.5725, 'train_samples_per_second': 8.83, 'train_steps_per_second': 1.124, 'train_loss': 0.40126864569527765, 'epoch': 20.0}
Finished Training
Saving Model at: /cluster/dataset/midatams/inf-extr/resources/models/line-label_medbert-512_token
Saving Tokenizer at: /cluster/dataset/midatams/inf-extr/resources/models/line-label_medbert-512_token
Job finished
