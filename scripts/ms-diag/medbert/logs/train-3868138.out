=====================================================================
                   Welcome to Leonhard Med v.2.0.1                    

 * Documentation:  https://unlimited.ethz.ch/display/LEOMED2
 * Support:        leomed-support@id.ethz.ch
 * Software stack: type "enable_modules" to use Modules

Tenant name: BIOMED
OS: Ubuntu 20.04.6 LTS x86_64 
Uptime: 12 days, 7 hours, 34 mins 
CPU: Intel (Broadwell, IBRS) (18) @ 2.199GHz 
CPU Usage: 31% 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
Memory: 74973MiB / 243821MiB (30%) 

=====================================================================
Starting job with ID 3868138...
Parsed Arguments:
job_id: unknown
model_name: medbert-512
quantization: None
batch_size: 32
lr: 0.0002
num_epochs: 12
gradient_accumulation_steps: 1
task_type: class
data: line
data_augmentation: oversample
num_labels: 4
peft_config: None
attn_implementation: None
GPU 0: NVIDIA GeForce GTX 1080 Ti
   Total Memory: 10.91 GB
   Free Memory: 10.45 GB
   Allocated Memory : 0.00 GB
   Reserved Memory : 0.00 GB
Tokenizer pad token ID: 0
Tokenizer special tokens: {'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'}
Model pad token ID: 0
Loaded Model and Tokenizer
Loaded Data
Starting Training
{'eval_loss': 0.3534153699874878, 'eval_accuracy': 0.7475, 'eval_f1': 0.664856675403596, 'eval_precision': 0.6243781094527363, 'eval_recall': 0.7475, 'eval_runtime': 1.0788, 'eval_samples_per_second': 370.792, 'eval_steps_per_second': 12.051, 'epoch': 1.0}
{'loss': 0.716, 'learning_rate': 0.00017222222222222224, 'epoch': 1.54}
{'eval_loss': 1.4420870542526245, 'eval_accuracy': 0.725, 'eval_f1': 0.6486544029977857, 'eval_precision': 0.6196172248803828, 'eval_recall': 0.725, 'eval_runtime': 1.0808, 'eval_samples_per_second': 370.089, 'eval_steps_per_second': 12.028, 'epoch': 2.0}
{'eval_loss': 1.0376458168029785, 'eval_accuracy': 0.7375, 'eval_f1': 0.6566774099722759, 'eval_precision': 0.61886041545331, 'eval_recall': 0.7375, 'eval_runtime': 1.1117, 'eval_samples_per_second': 359.799, 'eval_steps_per_second': 11.693, 'epoch': 3.0}
{'loss': 0.0928, 'learning_rate': 0.00014444444444444444, 'epoch': 3.08}
{'eval_loss': 1.0990464687347412, 'eval_accuracy': 0.7475, 'eval_f1': 0.6654103852596315, 'eval_precision': 0.625, 'eval_recall': 0.7475, 'eval_runtime': 1.1161, 'eval_samples_per_second': 358.375, 'eval_steps_per_second': 11.647, 'epoch': 4.0}
{'loss': 0.0056, 'learning_rate': 0.00011666666666666668, 'epoch': 4.62}
{'eval_loss': 1.5026943683624268, 'eval_accuracy': 0.74, 'eval_f1': 0.6604608730909582, 'eval_precision': 0.6237623762376238, 'eval_recall': 0.74, 'eval_runtime': 2.3783, 'eval_samples_per_second': 168.19, 'eval_steps_per_second': 5.466, 'epoch': 5.0}
{'eval_loss': 1.3097169399261475, 'eval_accuracy': 0.7425, 'eval_f1': 0.6617558073083, 'eval_precision': 0.6237623762376238, 'eval_recall': 0.7424999999999999, 'eval_runtime': 1.3857, 'eval_samples_per_second': 288.67, 'eval_steps_per_second': 9.382, 'epoch': 6.0}
{'loss': 0.001, 'learning_rate': 8.888888888888889e-05, 'epoch': 6.15}
{'eval_loss': 1.1236878633499146, 'eval_accuracy': 0.7425, 'eval_f1': 0.6617558073083, 'eval_precision': 0.6237623762376238, 'eval_recall': 0.7424999999999999, 'eval_runtime': 1.3953, 'eval_samples_per_second': 286.673, 'eval_steps_per_second': 9.317, 'epoch': 7.0}
{'loss': 0.0007, 'learning_rate': 6.111111111111112e-05, 'epoch': 7.69}
{'eval_loss': 1.093880534172058, 'eval_accuracy': 0.745, 'eval_f1': 0.6635877042853787, 'eval_precision': 0.6243781094527363, 'eval_recall': 0.745, 'eval_runtime': 1.3514, 'eval_samples_per_second': 295.99, 'eval_steps_per_second': 9.62, 'epoch': 8.0}
{'eval_loss': 1.720888376235962, 'eval_accuracy': 0.7425, 'eval_f1': 0.6617558073083, 'eval_precision': 0.6237623762376238, 'eval_recall': 0.7424999999999999, 'eval_runtime': 2.5734, 'eval_samples_per_second': 155.438, 'eval_steps_per_second': 5.052, 'epoch': 9.0}
{'loss': 0.0315, 'learning_rate': 3.3333333333333335e-05, 'epoch': 9.23}
{'eval_loss': 1.5249046087265015, 'eval_accuracy': 0.7425, 'eval_f1': 0.6617558073083, 'eval_precision': 0.6237623762376238, 'eval_recall': 0.7424999999999999, 'eval_runtime': 1.3724, 'eval_samples_per_second': 291.452, 'eval_steps_per_second': 9.472, 'epoch': 10.0}
{'loss': 0.0006, 'learning_rate': 5.555555555555556e-06, 'epoch': 10.77}
{'eval_loss': 1.4935911893844604, 'eval_accuracy': 0.7425, 'eval_f1': 0.6617558073083, 'eval_precision': 0.6237623762376238, 'eval_recall': 0.7424999999999999, 'eval_runtime': 1.3525, 'eval_samples_per_second': 295.756, 'eval_steps_per_second': 9.612, 'epoch': 11.0}
{'eval_loss': 1.4937657117843628, 'eval_accuracy': 0.7425, 'eval_f1': 0.6617558073083, 'eval_precision': 0.6237623762376238, 'eval_recall': 0.7424999999999999, 'eval_runtime': 1.3386, 'eval_samples_per_second': 298.825, 'eval_steps_per_second': 9.712, 'epoch': 12.0}
{'train_runtime': 111.9321, 'train_samples_per_second': 42.883, 'train_steps_per_second': 1.394, 'train_loss': 0.10882749613852073, 'epoch': 12.0}
Finished Training
Saving Model at: /cluster/dataset/midatams/inf-extr/resources/models/ms-diag_medbert-512_class_line_oversample
Saving Tokenizer at: /cluster/dataset/midatams/inf-extr/resources/models/ms-diag_medbert-512_class_line_oversample
Job finished
