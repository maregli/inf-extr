Starting job with ID 4287468...
Parsed Arguments:
job_id: unknown
model_name: medbert-512
quantization: None
batch_size: 16
lr: 0.0002
num_epochs: 16
gradient_accumulation_steps: 1
task_type: class
data: line
data_augmentation: oversample
num_labels: 4
peft_config: None
attn_implementation: None
GPU 0: NVIDIA GeForce RTX 2080 Ti
   Total Memory: 10.75 GB
   Free Memory: 10.14 GB
   Allocated Memory : 0.00 GB
   Reserved Memory : 0.00 GB
Tokenizer pad token ID: 0
Tokenizer special tokens: {'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'}
Model pad token ID: 0
Loaded Model and Tokenizer
Loaded Data
Starting Training
{'loss': 0.8544, 'learning_rate': 0.00019, 'epoch': 0.8}
{'eval_loss': 3.064467191696167, 'eval_accuracy': 0.4725, 'eval_f1': 0.3962214396297997, 'eval_precision': 0.3684834123222749, 'eval_recall': 0.47250000000000003, 'eval_runtime': 0.5232, 'eval_samples_per_second': 764.561, 'eval_steps_per_second': 47.785, 'epoch': 1.0}
{'loss': 0.2472, 'learning_rate': 0.00018, 'epoch': 1.6}
{'eval_loss': 3.420222759246826, 'eval_accuracy': 0.495, 'eval_f1': 0.41442953020134227, 'eval_precision': 0.37373737373737376, 'eval_recall': 0.495, 'eval_runtime': 0.5037, 'eval_samples_per_second': 794.195, 'eval_steps_per_second': 49.637, 'epoch': 2.0}
{'loss': 0.2465, 'learning_rate': 0.00017, 'epoch': 2.4}
{'eval_loss': 0.19741642475128174, 'eval_accuracy': 0.9725, 'eval_f1': 0.9724165600942852, 'eval_precision': 0.9752252252252253, 'eval_recall': 0.9725, 'eval_runtime': 0.4949, 'eval_samples_per_second': 808.308, 'eval_steps_per_second': 50.519, 'epoch': 3.0}
{'loss': 0.0955, 'learning_rate': 0.00016, 'epoch': 3.2}
{'loss': 0.0673, 'learning_rate': 0.00015000000000000001, 'epoch': 4.0}
{'eval_loss': 0.27881085872650146, 'eval_accuracy': 0.9625, 'eval_f1': 0.9624540061575431, 'eval_precision': 0.9635463772485178, 'eval_recall': 0.9625, 'eval_runtime': 0.5062, 'eval_samples_per_second': 790.221, 'eval_steps_per_second': 49.389, 'epoch': 4.0}
{'loss': 0.0015, 'learning_rate': 0.00014, 'epoch': 4.8}
{'eval_loss': 0.0884489044547081, 'eval_accuracy': 0.99, 'eval_f1': 0.9899959983993598, 'eval_precision': 0.9903846153846154, 'eval_recall': 0.99, 'eval_runtime': 0.76, 'eval_samples_per_second': 526.292, 'eval_steps_per_second': 32.893, 'epoch': 5.0}
{'loss': 0.0007, 'learning_rate': 0.00013000000000000002, 'epoch': 5.6}
{'eval_loss': 0.012461122125387192, 'eval_accuracy': 0.9975, 'eval_f1': 0.9974999374984375, 'eval_precision': 0.9975247524752475, 'eval_recall': 0.9975, 'eval_runtime': 0.8865, 'eval_samples_per_second': 451.22, 'eval_steps_per_second': 28.201, 'epoch': 6.0}
{'loss': 0.0465, 'learning_rate': 0.00012, 'epoch': 6.4}
{'eval_loss': 2.0990548133850098, 'eval_accuracy': 0.7475, 'eval_f1': 0.6641666041651041, 'eval_precision': 0.6225247524752475, 'eval_recall': 0.7475, 'eval_runtime': 0.7275, 'eval_samples_per_second': 549.861, 'eval_steps_per_second': 34.366, 'epoch': 7.0}
{'loss': 0.0603, 'learning_rate': 0.00011000000000000002, 'epoch': 7.2}
{'loss': 0.0191, 'learning_rate': 0.0001, 'epoch': 8.0}
{'eval_loss': 2.375307559967041, 'eval_accuracy': 0.74, 'eval_f1': 0.6572602013778485, 'eval_precision': 0.6128335949764522, 'eval_recall': 0.74, 'eval_runtime': 1.0409, 'eval_samples_per_second': 384.269, 'eval_steps_per_second': 24.017, 'epoch': 8.0}
{'loss': 0.0294, 'learning_rate': 9e-05, 'epoch': 8.8}
{'eval_loss': 2.1537210941314697, 'eval_accuracy': 0.7425, 'eval_f1': 0.6596050820188751, 'eval_precision': 0.6158148933024493, 'eval_recall': 0.7424999999999999, 'eval_runtime': 0.763, 'eval_samples_per_second': 524.221, 'eval_steps_per_second': 32.764, 'epoch': 9.0}
{'loss': 0.0014, 'learning_rate': 8e-05, 'epoch': 9.6}
{'eval_loss': 2.308656930923462, 'eval_accuracy': 0.7475, 'eval_f1': 0.6643080583703556, 'eval_precision': 0.62189661177173, 'eval_recall': 0.7475, 'eval_runtime': 0.7767, 'eval_samples_per_second': 515.021, 'eval_steps_per_second': 32.189, 'epoch': 10.0}
{'loss': 0.0225, 'learning_rate': 7e-05, 'epoch': 10.4}
{'eval_loss': 2.1306021213531494, 'eval_accuracy': 0.7325, 'eval_f1': 0.6502489653921617, 'eval_precision': 0.6041111810566074, 'eval_recall': 0.7325, 'eval_runtime': 0.7402, 'eval_samples_per_second': 540.379, 'eval_steps_per_second': 33.774, 'epoch': 11.0}
{'loss': 0.0227, 'learning_rate': 6e-05, 'epoch': 11.2}
{'loss': 0.0774, 'learning_rate': 5e-05, 'epoch': 12.0}
{'eval_loss': 0.5176250338554382, 'eval_accuracy': 0.7475, 'eval_f1': 0.6643080583703556, 'eval_precision': 0.62189661177173, 'eval_recall': 0.7475, 'eval_runtime': 0.8017, 'eval_samples_per_second': 498.962, 'eval_steps_per_second': 31.185, 'epoch': 12.0}
{'loss': 0.0011, 'learning_rate': 4e-05, 'epoch': 12.8}
{'eval_loss': 1.6418920755386353, 'eval_accuracy': 0.7475, 'eval_f1': 0.6643080583703556, 'eval_precision': 0.62189661177173, 'eval_recall': 0.7475, 'eval_runtime': 0.7086, 'eval_samples_per_second': 564.524, 'eval_steps_per_second': 35.283, 'epoch': 13.0}
{'loss': 0.0006, 'learning_rate': 3e-05, 'epoch': 13.6}
{'eval_loss': 1.6869308948516846, 'eval_accuracy': 0.7475, 'eval_f1': 0.6643080583703556, 'eval_precision': 0.62189661177173, 'eval_recall': 0.7475, 'eval_runtime': 0.7302, 'eval_samples_per_second': 547.776, 'eval_steps_per_second': 34.236, 'epoch': 14.0}
{'loss': 0.0006, 'learning_rate': 2e-05, 'epoch': 14.4}
{'eval_loss': 1.6963849067687988, 'eval_accuracy': 0.7475, 'eval_f1': 0.6643080583703556, 'eval_precision': 0.62189661177173, 'eval_recall': 0.7475, 'eval_runtime': 0.746, 'eval_samples_per_second': 536.202, 'eval_steps_per_second': 33.513, 'epoch': 15.0}
{'loss': 0.0236, 'learning_rate': 1e-05, 'epoch': 15.2}
{'loss': 0.0007, 'learning_rate': 0.0, 'epoch': 16.0}
{'eval_loss': 1.8728611469268799, 'eval_accuracy': 0.7475, 'eval_f1': 0.6643080583703556, 'eval_precision': 0.62189661177173, 'eval_recall': 0.7475, 'eval_runtime': 3.621, 'eval_samples_per_second': 110.465, 'eval_steps_per_second': 6.904, 'epoch': 16.0}
{'train_runtime': 131.7946, 'train_samples_per_second': 48.56, 'train_steps_per_second': 3.035, 'train_loss': 0.0909409289713949, 'epoch': 16.0}
Finished Training
Saving Model at: /cluster/dataset/midatams/inf-extr/resources/models/ms-diag_medbert-512_class_line_oversample
Saving Tokenizer at: /cluster/dataset/midatams/inf-extr/resources/models/ms-diag_medbert-512_class_line_oversample
Job finished
