Starting job with ID 4286479...
Parsed Arguments:
job_id: unknown
model_name: medbert-512
quantization: None
batch_size: 8
lr: 0.0002
num_epochs: 16
gradient_accumulation_steps: 1
task_type: class
data: all
data_augmentation: original_approach
num_labels: 3
peft_config: None
attn_implementation: None
GPU 0: NVIDIA GeForce RTX 2080 Ti
   Total Memory: 10.75 GB
   Free Memory: 10.14 GB
   Allocated Memory : 0.00 GB
   Reserved Memory : 0.00 GB
Tokenizer pad token ID: 0
Tokenizer special tokens: {'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'}
Model pad token ID: 0
Loaded Model and Tokenizer
Loaded Data
Starting Training
{'loss': 0.753, 'learning_rate': 0.00019193548387096775, 'epoch': 0.62}
{'eval_loss': 3.854238748550415, 'eval_accuracy': 0.3333333333333333, 'eval_f1': 0.2222222222222222, 'eval_precision': 0.16666666666666666, 'eval_recall': 0.3333333333333333, 'eval_runtime': 0.3479, 'eval_samples_per_second': 77.608, 'eval_steps_per_second': 11.498, 'epoch': 1.0}
{'loss': 0.2345, 'learning_rate': 0.00018387096774193548, 'epoch': 1.25}
{'loss': 0.2851, 'learning_rate': 0.00017580645161290325, 'epoch': 1.88}
{'eval_loss': 5.078405380249023, 'eval_accuracy': 0.3333333333333333, 'eval_f1': 0.2222222222222222, 'eval_precision': 0.16666666666666666, 'eval_recall': 0.3333333333333333, 'eval_runtime': 0.3278, 'eval_samples_per_second': 82.359, 'eval_steps_per_second': 12.201, 'epoch': 2.0}
{'loss': 0.1651, 'learning_rate': 0.00016774193548387098, 'epoch': 2.5}
{'eval_loss': 2.377760887145996, 'eval_accuracy': 0.6296296296296297, 'eval_f1': 0.5280112044817927, 'eval_precision': 0.49122807017543857, 'eval_recall': 0.6296296296296297, 'eval_runtime': 0.3293, 'eval_samples_per_second': 81.996, 'eval_steps_per_second': 12.148, 'epoch': 3.0}
{'loss': 0.2058, 'learning_rate': 0.00015967741935483872, 'epoch': 3.12}
{'loss': 0.283, 'learning_rate': 0.00015161290322580646, 'epoch': 3.75}
{'eval_loss': 2.6802289485931396, 'eval_accuracy': 0.6666666666666666, 'eval_f1': 0.5555555555555555, 'eval_precision': 0.5, 'eval_recall': 0.6666666666666666, 'eval_runtime': 0.3659, 'eval_samples_per_second': 73.792, 'eval_steps_per_second': 10.932, 'epoch': 4.0}
{'loss': 0.1903, 'learning_rate': 0.00014354838709677422, 'epoch': 4.38}
{'loss': 0.0009, 'learning_rate': 0.00013548387096774193, 'epoch': 5.0}
{'eval_loss': 2.759714126586914, 'eval_accuracy': 0.6666666666666666, 'eval_f1': 0.5555555555555555, 'eval_precision': 0.5, 'eval_recall': 0.6666666666666666, 'eval_runtime': 0.4221, 'eval_samples_per_second': 63.971, 'eval_steps_per_second': 9.477, 'epoch': 5.0}
{'loss': 0.0004, 'learning_rate': 0.0001274193548387097, 'epoch': 5.62}
{'eval_loss': 2.9748246669769287, 'eval_accuracy': 0.6666666666666666, 'eval_f1': 0.5555555555555555, 'eval_precision': 0.5, 'eval_recall': 0.6666666666666666, 'eval_runtime': 0.4468, 'eval_samples_per_second': 60.424, 'eval_steps_per_second': 8.952, 'epoch': 6.0}
{'loss': 0.0003, 'learning_rate': 0.00011935483870967743, 'epoch': 6.25}
{'loss': 0.0002, 'learning_rate': 0.00011129032258064515, 'epoch': 6.88}
{'eval_loss': 4.729285717010498, 'eval_accuracy': 0.3333333333333333, 'eval_f1': 0.3333333333333333, 'eval_precision': 0.3333333333333333, 'eval_recall': 0.3333333333333333, 'eval_runtime': 0.4796, 'eval_samples_per_second': 56.293, 'eval_steps_per_second': 8.34, 'epoch': 7.0}
{'loss': 0.0002, 'learning_rate': 0.0001032258064516129, 'epoch': 7.5}
{'eval_loss': 5.154138088226318, 'eval_accuracy': 0.3333333333333333, 'eval_f1': 0.3333333333333333, 'eval_precision': 0.3333333333333333, 'eval_recall': 0.3333333333333333, 'eval_runtime': 0.5242, 'eval_samples_per_second': 51.508, 'eval_steps_per_second': 7.631, 'epoch': 8.0}
{'loss': 0.0002, 'learning_rate': 9.516129032258065e-05, 'epoch': 8.12}
{'loss': 0.0002, 'learning_rate': 8.709677419354839e-05, 'epoch': 8.75}
{'eval_loss': 0.9011492133140564, 'eval_accuracy': 0.6666666666666666, 'eval_f1': 0.5555555555555555, 'eval_precision': 0.5, 'eval_recall': 0.6666666666666666, 'eval_runtime': 0.5203, 'eval_samples_per_second': 51.897, 'eval_steps_per_second': 7.688, 'epoch': 9.0}
{'loss': 0.0002, 'learning_rate': 7.903225806451613e-05, 'epoch': 9.38}
{'loss': 0.0001, 'learning_rate': 7.096774193548388e-05, 'epoch': 10.0}
{'eval_loss': 2.7228803634643555, 'eval_accuracy': 0.6666666666666666, 'eval_f1': 0.5555555555555555, 'eval_precision': 0.5, 'eval_recall': 0.6666666666666666, 'eval_runtime': 0.5204, 'eval_samples_per_second': 51.884, 'eval_steps_per_second': 7.687, 'epoch': 10.0}
{'loss': 0.0001, 'learning_rate': 6.290322580645161e-05, 'epoch': 10.62}
{'eval_loss': 2.838573932647705, 'eval_accuracy': 0.6666666666666666, 'eval_f1': 0.5555555555555555, 'eval_precision': 0.5, 'eval_recall': 0.6666666666666666, 'eval_runtime': 0.5224, 'eval_samples_per_second': 51.686, 'eval_steps_per_second': 7.657, 'epoch': 11.0}
{'loss': 0.0001, 'learning_rate': 5.4838709677419355e-05, 'epoch': 11.25}
{'loss': 0.0001, 'learning_rate': 4.67741935483871e-05, 'epoch': 11.88}
{'eval_loss': 2.8845295906066895, 'eval_accuracy': 0.6666666666666666, 'eval_f1': 0.5555555555555555, 'eval_precision': 0.5, 'eval_recall': 0.6666666666666666, 'eval_runtime': 0.5355, 'eval_samples_per_second': 50.417, 'eval_steps_per_second': 7.469, 'epoch': 12.0}
{'loss': 0.0001, 'learning_rate': 3.870967741935484e-05, 'epoch': 12.5}
{'eval_loss': 2.899326801300049, 'eval_accuracy': 0.6666666666666666, 'eval_f1': 0.5555555555555555, 'eval_precision': 0.5, 'eval_recall': 0.6666666666666666, 'eval_runtime': 0.5338, 'eval_samples_per_second': 50.585, 'eval_steps_per_second': 7.494, 'epoch': 13.0}
{'loss': 0.0001, 'learning_rate': 3.0645161290322585e-05, 'epoch': 13.12}
{'loss': 0.0001, 'learning_rate': 2.258064516129032e-05, 'epoch': 13.75}
{'eval_loss': 2.904458522796631, 'eval_accuracy': 0.6666666666666666, 'eval_f1': 0.5555555555555555, 'eval_precision': 0.5, 'eval_recall': 0.6666666666666666, 'eval_runtime': 0.5187, 'eval_samples_per_second': 52.05, 'eval_steps_per_second': 7.711, 'epoch': 14.0}
{'loss': 0.0001, 'learning_rate': 1.4516129032258066e-05, 'epoch': 14.38}
{'loss': 0.0001, 'learning_rate': 6.451612903225806e-06, 'epoch': 15.0}
{'eval_loss': 2.9076061248779297, 'eval_accuracy': 0.6666666666666666, 'eval_f1': 0.5555555555555555, 'eval_precision': 0.5, 'eval_recall': 0.6666666666666666, 'eval_runtime': 0.5175, 'eval_samples_per_second': 52.176, 'eval_steps_per_second': 7.73, 'epoch': 15.0}
{'loss': 0.0001, 'learning_rate': 0.0, 'epoch': 15.62}
{'eval_loss': 2.907484292984009, 'eval_accuracy': 0.6666666666666666, 'eval_f1': 0.5555555555555555, 'eval_precision': 0.5, 'eval_recall': 0.6666666666666666, 'eval_runtime': 0.5372, 'eval_samples_per_second': 50.262, 'eval_steps_per_second': 7.446, 'epoch': 16.0}
{'train_runtime': 322.2256, 'train_samples_per_second': 12.364, 'train_steps_per_second': 1.589, 'train_loss': 0.08283128040261545, 'epoch': 16.0}
Finished Training
Saving Model at: /cluster/dataset/midatams/inf-extr/resources/models/ms-diag_medbert-512_class_all_original_approach
Saving Tokenizer at: /cluster/dataset/midatams/inf-extr/resources/models/ms-diag_medbert-512_class_all_original_approach
Job finished
