=====================================================================
                   Welcome to Leonhard Med v.2.0.1                    

 * Documentation:  https://unlimited.ethz.ch/display/LEOMED2
 * Support:        leomed-support@id.ethz.ch
 * Software stack: type "enable_modules" to use Modules

Tenant name: BIOMED
OS: Ubuntu 20.04.6 LTS x86_64 
Uptime: 9 days, 4 hours, 59 mins 
CPU: Intel (Broadwell, IBRS) (18) @ 2.199GHz 
CPU Usage: 5% 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
Memory: 1580MiB / 243821MiB (0%) 

=====================================================================
Starting job with ID 3849699...
Parsed Arguments:
job_id: unknown
model_name: medbert-512
quantization: None
batch_size: 16
lr: 0.0002
num_epochs: 12
gradient_accumulation_steps: 1
task_type: class
data: all
data_augmentation: original_approach
num_labels: 3
peft_config: None
attn_implementation: None
GPU 0: NVIDIA GeForce GTX 1080 Ti
   Total Memory: 10.91 GB
   Free Memory: 10.45 GB
   Allocated Memory : 0.00 GB
   Reserved Memory : 0.00 GB
Tokenizer pad token ID: 0
Tokenizer special tokens: {'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'}
Model pad token ID: 0
Loaded Model and Tokenizer
Loaded Data
Starting Training
{'eval_loss': 1.7029420137405396, 'eval_accuracy': 0.3333333333333333, 'eval_f1': 0.2222222222222222, 'eval_precision': 0.16666666666666666, 'eval_recall': 0.3333333333333333, 'eval_runtime': 0.1368, 'eval_samples_per_second': 21.935, 'eval_steps_per_second': 7.312, 'epoch': 1.0}
{'loss': 0.9658, 'learning_rate': 0.00017777777777777779, 'epoch': 1.25}
{'eval_loss': 4.315895080566406, 'eval_accuracy': 0.3333333333333333, 'eval_f1': 0.2222222222222222, 'eval_precision': 0.16666666666666666, 'eval_recall': 0.3333333333333333, 'eval_runtime': 0.1279, 'eval_samples_per_second': 23.452, 'eval_steps_per_second': 7.817, 'epoch': 2.0}
{'loss': 0.1478, 'learning_rate': 0.00015555555555555556, 'epoch': 2.5}
{'eval_loss': 4.92918062210083, 'eval_accuracy': 0.3333333333333333, 'eval_f1': 0.2222222222222222, 'eval_precision': 0.16666666666666666, 'eval_recall': 0.3333333333333333, 'eval_runtime': 0.1207, 'eval_samples_per_second': 24.854, 'eval_steps_per_second': 8.285, 'epoch': 3.0}
{'loss': 0.0266, 'learning_rate': 0.00013333333333333334, 'epoch': 3.75}
{'eval_loss': 5.4313883781433105, 'eval_accuracy': 0.3333333333333333, 'eval_f1': 0.2222222222222222, 'eval_precision': 0.16666666666666666, 'eval_recall': 0.3333333333333333, 'eval_runtime': 0.1281, 'eval_samples_per_second': 23.422, 'eval_steps_per_second': 7.807, 'epoch': 4.0}
{'loss': 0.005, 'learning_rate': 0.00011111111111111112, 'epoch': 5.0}
{'eval_loss': 5.703408718109131, 'eval_accuracy': 0.3333333333333333, 'eval_f1': 0.2222222222222222, 'eval_precision': 0.16666666666666666, 'eval_recall': 0.3333333333333333, 'eval_runtime': 0.1233, 'eval_samples_per_second': 24.328, 'eval_steps_per_second': 8.109, 'epoch': 5.0}
{'eval_loss': 5.656814098358154, 'eval_accuracy': 0.3333333333333333, 'eval_f1': 0.2222222222222222, 'eval_precision': 0.16666666666666666, 'eval_recall': 0.3333333333333333, 'eval_runtime': 0.1266, 'eval_samples_per_second': 23.699, 'eval_steps_per_second': 7.9, 'epoch': 6.0}
{'loss': 0.0236, 'learning_rate': 8.888888888888889e-05, 'epoch': 6.25}
{'eval_loss': 3.6794795989990234, 'eval_accuracy': 0.3333333333333333, 'eval_f1': 0.2222222222222222, 'eval_precision': 0.16666666666666666, 'eval_recall': 0.3333333333333333, 'eval_runtime': 0.1312, 'eval_samples_per_second': 22.865, 'eval_steps_per_second': 7.622, 'epoch': 7.0}
{'loss': 0.0134, 'learning_rate': 6.666666666666667e-05, 'epoch': 7.5}
{'eval_loss': 5.395057201385498, 'eval_accuracy': 0.3333333333333333, 'eval_f1': 0.2222222222222222, 'eval_precision': 0.16666666666666666, 'eval_recall': 0.3333333333333333, 'eval_runtime': 0.1322, 'eval_samples_per_second': 22.693, 'eval_steps_per_second': 7.564, 'epoch': 8.0}
{'loss': 0.0004, 'learning_rate': 4.4444444444444447e-05, 'epoch': 8.75}
{'eval_loss': 5.830893039703369, 'eval_accuracy': 0.3333333333333333, 'eval_f1': 0.2222222222222222, 'eval_precision': 0.16666666666666666, 'eval_recall': 0.3333333333333333, 'eval_runtime': 0.1321, 'eval_samples_per_second': 22.704, 'eval_steps_per_second': 7.568, 'epoch': 9.0}
{'loss': 0.0004, 'learning_rate': 2.2222222222222223e-05, 'epoch': 10.0}
{'eval_loss': 5.884220123291016, 'eval_accuracy': 0.3333333333333333, 'eval_f1': 0.2222222222222222, 'eval_precision': 0.16666666666666666, 'eval_recall': 0.3333333333333333, 'eval_runtime': 0.1374, 'eval_samples_per_second': 21.841, 'eval_steps_per_second': 7.28, 'epoch': 10.0}
{'eval_loss': 5.897946834564209, 'eval_accuracy': 0.3333333333333333, 'eval_f1': 0.2222222222222222, 'eval_precision': 0.16666666666666666, 'eval_recall': 0.3333333333333333, 'eval_runtime': 0.1331, 'eval_samples_per_second': 22.534, 'eval_steps_per_second': 7.511, 'epoch': 11.0}
{'loss': 0.0003, 'learning_rate': 0.0, 'epoch': 11.25}
{'eval_loss': 5.898509979248047, 'eval_accuracy': 0.3333333333333333, 'eval_f1': 0.2222222222222222, 'eval_precision': 0.16666666666666666, 'eval_recall': 0.3333333333333333, 'eval_runtime': 0.1363, 'eval_samples_per_second': 22.007, 'eval_steps_per_second': 7.336, 'epoch': 12.0}
{'train_runtime': 258.0205, 'train_samples_per_second': 11.441, 'train_steps_per_second': 0.744, 'train_loss': 0.12329409604474979, 'epoch': 12.0}
Finished Training
Saving Model at: /cluster/dataset/midatams/inf-extr/resources/models/ms-diag_medbert-512_class_all_original_approach
Saving Tokenizer at: /cluster/dataset/midatams/inf-extr/resources/models/ms-diag_medbert-512_class_all_original_approach
Job finished
