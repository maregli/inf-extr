=====================================================================
                   Welcome to Leonhard Med v.2.0.1                    

 * Documentation:  https://unlimited.ethz.ch/display/LEOMED2
 * Support:        leomed-support@id.ethz.ch
 * Software stack: type "enable_modules" to use Modules

Tenant name: BIOMED
OS: Ubuntu 20.04.6 LTS x86_64 
Uptime: 9 days, 3 hours, 59 mins 
CPU: Intel (Broadwell, IBRS) (18) @ 2.199GHz 
CPU Usage: 4% 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
GPU: NVIDIA GeForce GTX 1080 Ti 
Memory: 1579MiB / 243821MiB (0%) 

=====================================================================
Starting job with ID 3849670...
Parsed Arguments:
job_id: unknown
model_name: medbert-512
peft_config: None
quantization: None
task_type: class
batch_size: 16
lr: 2e-05
num_epochs: 20
gradient_accumulation_steps: 1
num_labels: None
GPU 0: NVIDIA GeForce GTX 1080 Ti
   Total Memory: 10.91 GB
   Free Memory: 10.45 GB
   Allocated Memory : 0.00 GB
   Reserved Memory : 0.00 GB
Automatically inferred NUM_LABELS to: 8
Loaded Data
Tokenizer pad token ID: 0
Tokenizer special tokens: {'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'}
Model pad token ID: 0
Loaded Model and Tokenizer
Got Optimizer and Scheduler
Starting Training
{'loss': 1.7748, 'learning_rate': 1.9649122807017544e-05, 'epoch': 0.34}
{'loss': 1.0155, 'learning_rate': 1.929824561403509e-05, 'epoch': 0.69}
{'eval_loss': 0.43678000569343567, 'eval_accuracy': 0.8837209302325582, 'eval_precision': 0.8685383371385084, 'eval_recall': 0.750267094017094, 'eval_f1': 0.7629501586409689, 'eval_runtime': 0.6942, 'eval_samples_per_second': 371.67, 'eval_steps_per_second': 24.49, 'epoch': 1.0}
{'loss': 0.7084, 'learning_rate': 1.894736842105263e-05, 'epoch': 1.03}
{'loss': 0.421, 'learning_rate': 1.8596491228070176e-05, 'epoch': 1.38}
{'loss': 0.445, 'learning_rate': 1.824561403508772e-05, 'epoch': 1.72}
{'eval_loss': 0.27594006061553955, 'eval_accuracy': 0.937984496124031, 'eval_precision': 0.9251803751803752, 'eval_recall': 0.8782051282051282, 'eval_f1': 0.8934072889096907, 'eval_runtime': 0.7169, 'eval_samples_per_second': 359.891, 'eval_steps_per_second': 23.714, 'epoch': 2.0}
{'loss': 0.3682, 'learning_rate': 1.7894736842105264e-05, 'epoch': 2.07}
{'loss': 0.2477, 'learning_rate': 1.754385964912281e-05, 'epoch': 2.41}
{'loss': 0.2733, 'learning_rate': 1.719298245614035e-05, 'epoch': 2.76}
{'eval_loss': 0.31249305605888367, 'eval_accuracy': 0.9186046511627907, 'eval_precision': 0.8993335573476703, 'eval_recall': 0.8415064102564103, 'eval_f1': 0.8541843626111769, 'eval_runtime': 0.6931, 'eval_samples_per_second': 372.218, 'eval_steps_per_second': 24.526, 'epoch': 3.0}
{'loss': 0.1962, 'learning_rate': 1.6842105263157896e-05, 'epoch': 3.1}
{'loss': 0.1596, 'learning_rate': 1.649122807017544e-05, 'epoch': 3.45}
{'loss': 0.1777, 'learning_rate': 1.6140350877192984e-05, 'epoch': 3.79}
{'eval_loss': 0.28559988737106323, 'eval_accuracy': 0.9263565891472868, 'eval_precision': 0.8972380050505051, 'eval_recall': 0.8529647435897436, 'eval_f1': 0.8692127596613862, 'eval_runtime': 0.6922, 'eval_samples_per_second': 372.742, 'eval_steps_per_second': 24.561, 'epoch': 4.0}
{'loss': 0.122, 'learning_rate': 1.578947368421053e-05, 'epoch': 4.14}
{'loss': 0.0785, 'learning_rate': 1.543859649122807e-05, 'epoch': 4.48}
{'loss': 0.14, 'learning_rate': 1.5087719298245615e-05, 'epoch': 4.83}
{'eval_loss': 0.36740556359291077, 'eval_accuracy': 0.9147286821705426, 'eval_precision': 0.872208920016916, 'eval_recall': 0.8415064102564103, 'eval_f1': 0.8519704247975055, 'eval_runtime': 0.6938, 'eval_samples_per_second': 371.868, 'eval_steps_per_second': 24.503, 'epoch': 5.0}
{'loss': 0.1013, 'learning_rate': 1.4736842105263159e-05, 'epoch': 5.17}
{'loss': 0.0924, 'learning_rate': 1.4385964912280704e-05, 'epoch': 5.52}
{'loss': 0.0497, 'learning_rate': 1.4035087719298246e-05, 'epoch': 5.86}
{'eval_loss': 0.3673390746116638, 'eval_accuracy': 0.9263565891472868, 'eval_precision': 0.8995868658671078, 'eval_recall': 0.8602163461538461, 'eval_f1': 0.8658858972579441, 'eval_runtime': 0.6944, 'eval_samples_per_second': 371.536, 'eval_steps_per_second': 24.481, 'epoch': 6.0}
{'loss': 0.1057, 'learning_rate': 1.3684210526315791e-05, 'epoch': 6.21}
{'loss': 0.0807, 'learning_rate': 1.3333333333333333e-05, 'epoch': 6.55}
{'loss': 0.0562, 'learning_rate': 1.2982456140350879e-05, 'epoch': 6.9}
{'eval_loss': 0.3141823709011078, 'eval_accuracy': 0.9263565891472868, 'eval_precision': 0.8878214768113024, 'eval_recall': 0.8617120726495727, 'eval_f1': 0.8699739707588389, 'eval_runtime': 0.697, 'eval_samples_per_second': 370.151, 'eval_steps_per_second': 24.39, 'epoch': 7.0}
{'loss': 0.0406, 'learning_rate': 1.263157894736842e-05, 'epoch': 7.24}
{'loss': 0.1055, 'learning_rate': 1.2280701754385966e-05, 'epoch': 7.59}
{'loss': 0.0711, 'learning_rate': 1.192982456140351e-05, 'epoch': 7.93}
{'eval_loss': 0.315787136554718, 'eval_accuracy': 0.9263565891472868, 'eval_precision': 0.8827568265068265, 'eval_recall': 0.8757077991452991, 'eval_f1': 0.8767709431780945, 'eval_runtime': 0.6946, 'eval_samples_per_second': 371.449, 'eval_steps_per_second': 24.475, 'epoch': 8.0}
{'loss': 0.0452, 'learning_rate': 1.1578947368421053e-05, 'epoch': 8.28}
{'loss': 0.0374, 'learning_rate': 1.1228070175438597e-05, 'epoch': 8.62}
{'loss': 0.0322, 'learning_rate': 1.0877192982456142e-05, 'epoch': 8.97}
{'eval_loss': 0.39775943756103516, 'eval_accuracy': 0.9224806201550387, 'eval_precision': 0.8798314080243428, 'eval_recall': 0.8451522435897436, 'eval_f1': 0.8550337930397329, 'eval_runtime': 0.6956, 'eval_samples_per_second': 370.888, 'eval_steps_per_second': 24.438, 'epoch': 9.0}
{'loss': 0.0285, 'learning_rate': 1.0526315789473684e-05, 'epoch': 9.31}
{'loss': 0.0612, 'learning_rate': 1.017543859649123e-05, 'epoch': 9.66}
{'loss': 0.0537, 'learning_rate': 9.824561403508772e-06, 'epoch': 10.0}
{'eval_loss': 0.38845115900039673, 'eval_accuracy': 0.9186046511627907, 'eval_precision': 0.8678216970368133, 'eval_recall': 0.8470619658119658, 'eval_f1': 0.8546141501352255, 'eval_runtime': 0.6765, 'eval_samples_per_second': 381.372, 'eval_steps_per_second': 25.129, 'epoch': 10.0}
{'loss': 0.027, 'learning_rate': 9.473684210526315e-06, 'epoch': 10.34}
{'loss': 0.0311, 'learning_rate': 9.12280701754386e-06, 'epoch': 10.69}
{'eval_loss': 0.42530685663223267, 'eval_accuracy': 0.9263565891472868, 'eval_precision': 0.8945883524687872, 'eval_recall': 0.8555689102564104, 'eval_f1': 0.8683378444990264, 'eval_runtime': 0.6959, 'eval_samples_per_second': 370.724, 'eval_steps_per_second': 24.428, 'epoch': 11.0}
{'loss': 0.026, 'learning_rate': 8.771929824561405e-06, 'epoch': 11.03}
{'loss': 0.0327, 'learning_rate': 8.421052631578948e-06, 'epoch': 11.38}
{'loss': 0.0068, 'learning_rate': 8.070175438596492e-06, 'epoch': 11.72}
{'eval_loss': 0.4156676232814789, 'eval_accuracy': 0.9147286821705426, 'eval_precision': 0.8675517191142191, 'eval_recall': 0.8583466880341881, 'eval_f1': 0.861713391527309, 'eval_runtime': 0.6958, 'eval_samples_per_second': 370.8, 'eval_steps_per_second': 24.433, 'epoch': 12.0}
{'loss': 0.0277, 'learning_rate': 7.719298245614036e-06, 'epoch': 12.07}
{'loss': 0.0159, 'learning_rate': 7.368421052631579e-06, 'epoch': 12.41}
{'loss': 0.0238, 'learning_rate': 7.017543859649123e-06, 'epoch': 12.76}
{'eval_loss': 0.4597110450267792, 'eval_accuracy': 0.9147286821705426, 'eval_precision': 0.87245670995671, 'eval_recall': 0.833173076923077, 'eval_f1': 0.845828506050524, 'eval_runtime': 0.6972, 'eval_samples_per_second': 370.071, 'eval_steps_per_second': 24.385, 'epoch': 13.0}
{'loss': 0.0182, 'learning_rate': 6.666666666666667e-06, 'epoch': 13.1}
{'loss': 0.0077, 'learning_rate': 6.31578947368421e-06, 'epoch': 13.45}
{'loss': 0.0112, 'learning_rate': 5.964912280701755e-06, 'epoch': 13.79}
{'eval_loss': 0.4159029722213745, 'eval_accuracy': 0.9186046511627907, 'eval_precision': 0.8670167727943892, 'eval_recall': 0.8408119658119658, 'eval_f1': 0.8489811370011453, 'eval_runtime': 0.696, 'eval_samples_per_second': 370.693, 'eval_steps_per_second': 24.425, 'epoch': 14.0}
{'loss': 0.0091, 'learning_rate': 5.6140350877192985e-06, 'epoch': 14.14}
{'loss': 0.0088, 'learning_rate': 5.263157894736842e-06, 'epoch': 14.48}
{'loss': 0.0198, 'learning_rate': 4.912280701754386e-06, 'epoch': 14.83}
{'eval_loss': 0.42379358410835266, 'eval_accuracy': 0.9186046511627907, 'eval_precision': 0.8664028679653679, 'eval_recall': 0.8486244658119658, 'eval_f1': 0.8546473113701123, 'eval_runtime': 0.6984, 'eval_samples_per_second': 369.407, 'eval_steps_per_second': 24.341, 'epoch': 15.0}
{'loss': 0.0034, 'learning_rate': 4.56140350877193e-06, 'epoch': 15.17}
{'loss': 0.0051, 'learning_rate': 4.210526315789474e-06, 'epoch': 15.52}
{'loss': 0.0161, 'learning_rate': 3.859649122807018e-06, 'epoch': 15.86}
{'eval_loss': 0.44255000352859497, 'eval_accuracy': 0.9186046511627907, 'eval_precision': 0.8718621010772174, 'eval_recall': 0.8486244658119658, 'eval_f1': 0.8570481310400979, 'eval_runtime': 0.6968, 'eval_samples_per_second': 370.262, 'eval_steps_per_second': 24.397, 'epoch': 16.0}
{'loss': 0.0031, 'learning_rate': 3.5087719298245615e-06, 'epoch': 16.21}
{'loss': 0.0078, 'learning_rate': 3.157894736842105e-06, 'epoch': 16.55}
{'loss': 0.0038, 'learning_rate': 2.8070175438596493e-06, 'epoch': 16.9}
{'eval_loss': 0.4366057515144348, 'eval_accuracy': 0.9186046511627907, 'eval_precision': 0.8633815836940837, 'eval_recall': 0.8416800213675213, 'eval_f1': 0.8483191739278444, 'eval_runtime': 0.6977, 'eval_samples_per_second': 369.804, 'eval_steps_per_second': 24.367, 'epoch': 17.0}
{'loss': 0.0045, 'learning_rate': 2.456140350877193e-06, 'epoch': 17.24}
{'loss': 0.0052, 'learning_rate': 2.105263157894737e-06, 'epoch': 17.59}
{'loss': 0.009, 'learning_rate': 1.7543859649122807e-06, 'epoch': 17.93}
{'eval_loss': 0.43562906980514526, 'eval_accuracy': 0.9186046511627907, 'eval_precision': 0.8633815836940837, 'eval_recall': 0.8416800213675213, 'eval_f1': 0.8483191739278444, 'eval_runtime': 0.6976, 'eval_samples_per_second': 369.835, 'eval_steps_per_second': 24.369, 'epoch': 18.0}
{'loss': 0.0062, 'learning_rate': 1.4035087719298246e-06, 'epoch': 18.28}
{'loss': 0.0028, 'learning_rate': 1.0526315789473685e-06, 'epoch': 18.62}
{'loss': 0.0067, 'learning_rate': 7.017543859649123e-07, 'epoch': 18.97}
{'eval_loss': 0.43712130188941956, 'eval_accuracy': 0.9186046511627907, 'eval_precision': 0.8681164321789322, 'eval_recall': 0.8416800213675213, 'eval_f1': 0.8493498176668215, 'eval_runtime': 0.696, 'eval_samples_per_second': 370.675, 'eval_steps_per_second': 24.424, 'epoch': 19.0}
{'loss': 0.0027, 'learning_rate': 3.5087719298245616e-07, 'epoch': 19.31}
{'loss': 0.0082, 'learning_rate': 0.0, 'epoch': 19.66}
{'loss': 0.0025, 'learning_rate': 0.0, 'epoch': 20.0}
{'eval_loss': 0.43426513671875, 'eval_accuracy': 0.9186046511627907, 'eval_precision': 0.8633815836940837, 'eval_recall': 0.8416800213675213, 'eval_f1': 0.8483191739278444, 'eval_runtime': 0.677, 'eval_samples_per_second': 381.09, 'eval_steps_per_second': 25.111, 'epoch': 20.0}
{'train_runtime': 257.7612, 'train_samples_per_second': 71.151, 'train_steps_per_second': 4.5, 'train_loss': 0.12831632838873513, 'epoch': 20.0}
Finished Training
Saving Model at: /cluster/dataset/midatams/inf-extr/resources/models/line-label_medbert-512_class
Saving Tokenizer at: /cluster/dataset/midatams/inf-extr/resources/models/line-label_medbert-512_class
Job finished
